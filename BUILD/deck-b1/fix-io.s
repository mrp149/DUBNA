Cs
Cs Fixes in the main I/O task  03/03/2017
Cs
Cs  TRAM70 - suppressing the CW checking on DRUM
Cs
 TRAM70  :  ,NAME,
C---------
C
C       MAЙ  1983.  H.C.ГOHЧAPOB.
C
C   (И ДO HEГO MHOГИE XOTEЛИ ПEPEПИCATЬ
C    ЗAДAЧY OБMEHA, HO HИKTO HE PEШИЛCЯ).
C
C--------
C
 *ИПД:LC,BLOCK,(16)
  ,CONT,XLTF,LENTDIS
 ,CONT,(1),Ш/ДИCП,(22)
  ,CONT,OUTJOBSC
  ИПЗ/ECTЬ:,EQU,*ИПД+42B
  MTRACNT:,EQU,*ИПД+27B
  LQTRA:,WEQ,MTRACNT.ДЛИHA WL
 LTF:,WEQ,XLTF.ДЛИHA FATA
C---------
  CHEKMDFL:,LC,1.БЛOKИP.OШ.MБ
C---------
 SELECT:,SUBP,.
 COБЫTИE:,SUBP,
 CLANEWTA:,SUBP,.
 TTPRINT :  ,SUBP,
 ERRPRI  :  ,SUBP,
  OШMAШИHЫ:,EQU,ERRPRI
 OUTCW:,LC,1.
 OUTJOB:,SUBP,.
 ABCHT:,SUBP,
C
  TIMERS:LC,BLOCK,TMБ(2),TMД(2),MTTIMCNT(4)
  *TAKCA:LC,BLOCK,(1),DISTIME,TAPTIME
C
 *677:B,BLOCK,BITS,BIT48,BIT47,BIT46,BIT45,BIT44,BIT43,BIT42,BIT41,
       , CONT,     BIT40,BIT39,BIT38,BIT37,BIT36,BIT35,BIT34,BIT33,
       , CONT,     BIT32,BIT31,BIT30,BIT29,BIT28,BIT27,BIT26,BIT25,
       , CONT,     BIT24,BIT23,BIT22,BIT21,BIT20,BIT19,BIT18,BIT17,
       , CONT,     BIT16,BIT15,BIT14,BIT13,BIT12,BIT11,BIT10,BIT9 ,
       , CONT,     BIT8 ,BIT7 ,BIT6 ,BIT5 ,BIT4 ,BIT3 ,BIT2 ,BIT1
 BITTRA:,EQU,BIT27.
 PEBEPC:,EQU,BIT24.
 HAЛOЖ:,EQU,BIT23.
 CЛYЖCЛOB:,EQU,BIT21.
 ЛИCTOБM:,EQU,BIT19.
 ЧTEHИE:,EQU,BIT18.
 ПOДBOД:,EQU,BIT16.
 BITПOДB:,EQU,BIT6.
 BITИMЯ:,EQU,BIT5.
  MAXTIMET:,EQU,BIT8.TAЙMEP MЛ
  CREADIS:,EQU,BIT5.B T1MT
  CONTROL:,EQU,BIT4.B T1MT
 *C :,LC,
 *CB:,LC,
  *TLCONST:,LC,
  MASK12:,LC,3
 FULWOR  :  ,LC,1
 *YCЫ:LC,BLOCK,ГYC,RDSCAL,COMMIR
 ДHЗ:LC,BLOCK,(1),BITJ,ZBITJ
C
  EXCHJOB:,LC,2.KЛИEHTЫ SWING-A
C
 JNREC:,EQU,27B.OПOЗHABAHИE
 SMASAV:LC,BLOCK,
            ,CONT,      SAVAC
            ,CONT,      SAVSR
 ,CONT,(1)
            ,CONT,      SAVI15
C
C<<<<<<<<<<<<<<< И П З >>>>>>>>>>>>>>>>
C
 ST/EXCH:,EQU,-2
 *0:,BLOCK,(3),S33(2),S27(3),I14(16)
    ,CONT ,TMATH(0),TПPИП(8),TЗAЩ(4),(28)
    ,CONT ,(6),COPYS33(2),BISTIME(2),SCEX(3)
    ,CONT ,SYSMD(10),MЛД,PЛД
  REGSCAL:,EQU,100B.ФЛAГИ
  CWPLAC:,EQU,150B.MECTO CЛ.CЛOB
C
C<<<<<<< OБЬEKTЫ ЗAДAЧИ OБMEHA >>>>>>>>
C
 PUT16:,SUBP,
 TYPEMT:,SUBP,
  FIX DENS:,EQU,TYPEMT+5
 BUFTRA:LC,BLOCK,(1),IFTRA(36).
 DRIDENT:LC,BLOCK,(1),KYC
  TRA MASK:LC,BLOCK,(1),FINZON
 TRABUS  :  ,LC,1
 TRACNT  :  ,LC,1
 FULQUESC:  ,LC,1
 TPAKTCT:,EQU,541B
C
  REWINDSC:LC,BLOCK,(1),ЗAKЗAП,CONTRWR
 ,CONT,CHBOSS(4)
C..  CMЫCЛ ЯЧEEK БЛOKA REWINDSC :
C   4-7.   48P.- HYЖEH ПEPEXBAT ПPEPЫBAHИЯ
C              ПO ПPOXOДY ЗOHЫ B 3-6 HAПP.
C      1-15P.- AДPEC ПPOЦEДYPЫ ПEPEXBATA.
C  /ЗAKAЗ ПEPEXBATA БЛOKИPYET PAБOTY ЗAДAЧИ
C  OБMEHA CO BCEM   Y B Y  - HAПPABЛEHИEM/.
C
C   1.  '1' B 48-17 PAЗPЯДAX ECTЬ
C     ПPИЗH. HECMOTKИ HA HAЧAЛO MЛ 30-67.
C
C   2.  '1' B 48-1 P. - ПPИЗH. PAЗPEШEHИЯ
C     ЗAПИCИ HA MЛ/MOДEЛЬ  10-67.
C
C   3.   '1' B 48-1 P. - HYЖEH KOHTPOЛЬ
C     COCTOЯHИЯ ЗAПИCИ HA MЛ/MOДEЛИ 10-67.
C
C-----------------------------------------
 IW70    :  ,LC,1
 CWJFOTRA:  ,LC,1.YC ЗAKAЗЧИKA
 TPHYS   :  ,LC,1
 RETTRA:LC,BLOCK,W04265.ПEPEXBAT "KЧ"
 TASKSTRA:LC,BLOCK,.
  ,CONT,TBUC(6),TBUT(6)
 ,CONT,CSUM(0),CSUMSTAT(6)
 SCALSTRA:LC,BLOCK,.
  ,CONT,SBUC(6),SRJC(6)
  ,CONT,SJMT(32)
  ,CONT,SJMD(16),SCADDS
  ,CONT,БYPЖYЙ
  ,CONT,SCSWING.ШK.OБMEHOB ПOДKAЧKИ
C
C---   OЧEPEДЬ ЗAKAЗOB HA OБMEH:
C
 LISTSTRA:LC,BLOCK,WL1.KYC-Ы
  WL2:,EQU,WL1+LQTRA.KOHTP.CYMMЫ
C
  TABLEMT:LC,BLOCK,T1MOD(16),T1MT(32)
  ,CONT,T2MOD(16),T2MT(32)
  ,CONT,TNMOD(16),TANAMEMT(32)
C
C       TANAMEMT - ИMEHA ЛEHT
C               T1MT :
C    48-43 : ДHЗ BЛAДEЛЬЦA ИЛИ 0
C    42-37 : MATEMATИЧECKИЙ HOMEP
C    36-31 : БИTЫ OШИБOK (CЛEBA HAПPABO:
C            OШM,OШ/ЗП,OШ/CC,KO/ЗП,KC,CИ)
C    30-26 : CЧETЧИK ЧИCЛA OШИБOK TEK.OБMEHA
C    24-13 : CMEЩEHИE ПO ЛEHTE (*TAPES)
C     12   : CБPOC ДBИЖ.ПO TAЙMEPY (KДB)
C    11-10 : ПЛOTHOCTЬ ЗAПИCИ
C      8   : БЫЛ ПPИKAЗ "KO"
C      5   : ИДET KOHTPOЛЬHOE ЧTEHИE
C      4   : ЗAKAЗAH PEЖИM ЗAПИCИ C KOHTPOЛEM
C     3-2  : CTATYC ЛEHTЫ
C      1   : ПPИЗHAK ПEPBOГO OБPAЩEHИЯ
C                T2MT :
C     48   : PAБOTAEM C ДYБЛEM ЗOHЫ
C     44   : OШИБKA B OCHOBHOЙ ЗOHE
C    43-42 : CЧETЧИK HAЛOЖEHИЙ ПPИ ЧTEHИИ
C    41-25 : PEГИCTP COCTOЯHИЯ ДЛЯ MЛ EC
C    24-13 : TPEБYEMAЯ ЗOHA (ЧETHAЯ!)
C    12-1  : TEKYЩAЯ ЗOHA
C
 LTDIS:,WEQ,LENTDIS.ДЛИHA TAБЛ.ЭKCTEHTOB
 LTD:,EQU,LTDIS-1.
 LTD*3:,P*P,(LTD)3
 *TDIS:,LC,LTDIS.TAБЛИЦA
 TDIS:,EQU,*TDIS.ЭKCTEHTOB
  *DISCS:LC,BLOCK,(32),ШMOД,ШФЛД
  FATA:,LC,1.TAБЛИЦA ФAЙЛOB
  TSF:,EQU,425B.TAБЛ.SCR-OБЛ. (8 CЛOB)
  LTS:,EQU,7.EE ДЛИHA-1
C
 *KOHCTPA:LC,BLOCK,KOHTPCTP.KOHTP.ЗAП.HA MБ
 SCDICH:,SUBP,
 DISC:,SUBP,.
  DAFSET:,SUBP,.
 RECMDT:,SUBP,.KAHAЛ OПOЗH.
 CHVOP:,SUBP,
 CHPOP:,SUBP,
 PS*VOP:,SUBP,
 PS*POP:,SUBP,
 DISREG  :  ,LC,1
 *SWCMN:LC,BLOCK,(10),SWINGIF(25)
 EXCHSC:,EQU,*SWCMN+3
 *STATBUF:LC,BLOCK,(14),MДMЛMБ
C
C
C...    BXOДЫ OT MACRO70 И TRAPHY:
C
 ADREQ40:,UJ,MACSTART
 ,Z00,PHYREQ40
C
C
  HA COБ:8,,
  ,Z00,HE COБ
 STD:2,Z01,БYCT.
 ,Z02,.
  ST/T:2,Z02,БYCT.
 ,Z02,AFT ST.
 MOШMБ:,LOG,10 00100 010 00100.
 STATIST:,SUBP,.
C
C...  HOMEPA ДИAГHOCTИK  ERRMACRO :
C
  *12:,BLOCK,AOШM(6),ЧYЖAЯMЛ,ЗAKPAБMД
  ,CONT,ЧYЖTPEK,ЗAПPETЗП,ДHEГOT,MЛKAЮK
 A*TOШMБ:,,
 ,Z00,T OШMБ.
 T ЗПMБ:,ISO,6HЗП MБ:
 TEXER0:,BSS,
 ,ISO,6HMБ KO:
 ,ISO,6HMБOШM:
 ,ISO,6HKЧ KC:
 ,ISO,6HЗПOШM:
 TOШMБ:,BSS,1
 БYCT:,BSS,.
 ЖEAД:,BSS,1
 ШИФP:,BSS,
 ПOAД:,BSS,2
 TOШMЛ:,BSS,.
 ,ISO,12HЧYЖAЯ MЛ - '1'
 ,BSS,1
 THEOПO:,BSS,.
 ,ISO,12HHE OПOЗH.MЛ-
  ,BSS,1
 ,ISO,12HHEГOTOB.MФ-'1'
  HOMФ:,BSS,1
  ,ISO,12HHET ЗAП.MФ-'1'
  ,BSS,1
 TЦKMФ:,BSS,3.
 ,LOG,
 TMБCДOX:,BSS,.
 ,ISO,6HЧП MБ.
 ,BSS,1.
  MTDIAGN:,BSS,
  ,ISO,6HOШ/ЧT
  ,ISO,6HOШ/ЗП
  ,ISO,6HOШ/CC
  ,ISO,6HKO/ЗП
  ,ISO,6HKC MЛ
  ,ISO,6HCБ/CИ
 ,ISO,6HKДB MФ
  HEYГACИM:,ISO,18HHET CБPOCA CДB-6'41'''
  TБЯKA   :,ISO,6HДB-0'41'''
  CTMБ:,LC,2
  PERMIR:,SUBP,
 FWCR:,LOG,.ФЛAГ OП.KAH.
  C200*:,EQU,*TLCONST+11B
  B48/43:,EQU,*TLCONST+22B
 B48/13:,EQU,*CB+4
 B41/1 :,LOG,37 7777 7777 7777
 B39/25:,OCT,0007 7777
 B37/31:,OCT,0001 77
  B36/31:,EQU,*CB+3
 B30/16:,LC ,1
 B30*12*5:,LOG,40 0000 4020
 B29/26:,OCT,0000 0036
 B24/14:,LOG,7776 0000
  B24/13:,EQU,MASK12+2
 B24/1 :,LC ,1
 B22*18:,LOG,1040 0000
 B21/19:,LOG,700 0000
 B21/18:,LOG,740 0000
 B21*18:,LOG,440 0000
 B20/19:,LOG,300 0000
 B19*12:,LOG,100 4000
 B16/1 :,LC ,1
 B11/10:,LOG,3000
 C1    :,EQU,BIT1
 C2    :,EQU,BIT2
 C3    :,LC ,1
 C6    :,EQU,*C
 C7    :,LC ,1
 C13   :,LC ,1
 C17   :,EQU,*CB+1
 C37   :,LC ,1
 C77   :,LC ,1
 C377  :,LC ,1
 C1400 :,LC ,1
 C2003 :,LC ,1
 C3777 :,LC ,1
 C7777 :,LC ,1
 C77774:,LOG,77774
 ZBIT13:,OCT,7777 7777 7776 7777
 ZBIT12:,OCT,7777 7777 7777 3777
  ZBIT1:,EQU,*TLCONST+20B
  ZB7*6:,OCT,7777 7777 7777 7637
 ZB37*23:,OCT,7776 7777 5777 7777
 Z21*18*1:,OCT,7777 7777 7337 7776
 ZC7   :,OCT,7777 7777 7777 7770
 BY1/2 :,GOST,6H770000
 BY1/5 :,GOST,6H777770
 BY5/6 :,GOST,6H000077
 Z12   :,ISO ,6H00''''''''
 Z12Ш  :,ISO ,6H00-Ш00
        ,BSS,.MERDE
C
C<<<< KOHCTAHTЫ БЛOKA OБMEHA C MЛ >>>>>
C
 KPYГ  :,LOG,11
 C/ПEP :,OCT,0000 06
 KYCMAC:,OCT,7777 7777 7477 1600
 MASK5017:,LOG,114
 TKYC17  :,GOST,6H000'20''40''101'
 CW0C  :,OCT,2245 1252 5122 4512
 CW36C :,OCT,0007 0707
 CW4C  :,OCT,7163 4760 3471 6347
 LWC   :,OCT,6666 6666 6666 6666
 MASWL :,OCT,7777 7777 5777 7660
 MAST1MT:,OCT,7777 0000 7777 3037
 MAST2MT:,OCT,1577 7777 7777 7777
 TNZON  :,ISO,6H/0000/
        ,BSS,.MERDE
C
C<<< PAБ. ЯЧEЙKИ БЛOKA OБMEHA C MЛ >>>>
C
 CH     :,BSS,1
 IDMT   :,BSS,1
 KYCДB  :,BSS,1
 NZON   :,BSS,1
 DENS   :,BSS,1
 PEFL   :,BSS,1
 CHSUMR :,BSS,1
 TИПOШ  :,BSS,1
 OFFKYC :,BSS,1
 CЧETП  :,BSS,1
 ПPOBMФ :,EQU,TRAMASK
 EXCHFL :,EQU,KYCДB
C
C<<<<< ЭKB-CTИ БЛOKA OБMEHA C MЛ >>>>>>
C
 *1:,BLOCK,OШ/ЧT,OШ/ЗП,OШ/CC,KO/ЗП
    ,CONT ,KC/MЛ,CБ/CИ,KДB/MФ
 TPDI:,EQU,6
 BITDI:,EQU,BIT8
C
C<<<<< PEГИCTPЫ БЛOKA OБMEHA C MЛ >>>>>
C
 *1 :,BLOCK,(1),NF,MF,ER
 *6 :,BLOCK,(1),RF,( 2 ) ,DC
 *11:,BLOCK,CW ,N ,I
C
C<<<<<<<<<                    >>>>>>>>>
C
 B12/11  :  ,LOG, 00000000 00006000
 BITNAM:,LOG,400 0020
 BITMOV:,LOG,400 0040
 RBITSM:,OCT,1474 0000 004
 MDRADM:,LOG,37 0037
 KDRADM:,LOG,30 0000 0000 1777
 DIDM:,OCT,7700 0000 0077 3740
 SCR*D:,OCT,5750
 SCR*P:,OCT,37 37 77
 KUNITM:,LOG,70 0000 0000 1600
 MS/70:,OCT,4000 0003 0000 03
 MS/KYC:,LOG,100 6003
 MMNTPL:,OCT,0007 7007 7
 KPMASK:,LOG,1 4037 0000
 PПMASK:,LOG,420 0000 0037
 TMPMASK:,LOG, 1 0400 0037
 ,LOG, 2 1000 1740
 ,LOG, 4 2007 6000
 ,LOG,10 4370 0000
 BC1700:,ENTRY,
 BC1700:,BSS,1.CBOБOДHA !
 ,LOG,10.
 ,LOG,20.
 ,LOG,30.
 ,LOG,40.
 ,LOG,50.
 ,LOG,60.
 TSCRFI:,BSS,7.PAБ. ПOЛE ЗAД. OБMEHA
 KYC39:,BSS,1
 KYC40:,BSS,1
  COMPUT16:LC,BLOCK,NH,N8,BN8
  PRTMTCH:,OCT,754
 NOCHECK:,TEXT,8HNO CHECK
 ДHЗПOДK:,LOG,24.
 CON1:,LOG,37 373.
 CON6:,LOG,7777 7776 3740 7777
 CON7:,LOG,7776 0001 4037 1774.
C
 STATUSMT:LC,BLOCK,(1),OLD(4),NEW(4)
 ,CONT,W05741(4)
 ,CONT,SOST,(1),ДBECA(4),SCANER
 ,CONT,ШKEC(4),SCMT57(4)
 ,CONT,ШHГ(4)
  ,CONT,MISTERX
C
 BY4/5:,GOST,6H000770
 KAДMБ:,ISO,6H00000.
 KШИ:,ISO,6H'1''1'Ш00''
 UPM 1:,GOST,6H373730
 B25*16:,LOG,1 001 00000
  C/MГЗ:,EQU,BIT36
  COUNT:,BSS,4
 SAVI11:,BSS,.
 ,BSS,1
 Ш ЧYMЛ:,BSS,1
 R1:,BSS,1
 ЖДYKOHTP:,BSS,1
 ЗAHKOHTP:,BSS,1
 OFFESC:,BSS,1.
 QUEONLY:,BSS,1.ФЛAГ BXOДA OT SWING
C
 DISPBASE:LC,BLOCK,(2),*DR2122(2)
  ,CONT,DISPMD(2)
  ,CONT,DSHIFT
C
 YЧET:,ISO,12HYЧET ЗAKPЫT'0'
 BITWP:,EQU,BIT30
 BITPAG:,EQU,BIT19
 BITRD:,EQU,BIT18
 BDSEC:,EQU,BIT7
 C50:,EQU,BC1700+5
 NRB:,EQU,7
 NRBS:,EQU,48-NRB
 TSCRFI:I,BLOCK,SECT(0),WLSUM.DTASKON
 ,CONT,KSJN(0),FSUM.S48TO12
 ,CONT,DISAD(0),RSUM.S48TO12
 ,CONT,IDENT(0),RRR.PRIPTRA
  ,CONT,DID
 ,CONT,KPAGE(0),MPAGE.OPENPAG
 ,CONT,RBITS(0),WS
C
C
 *1 :,BLOCK,U ,CT,NR,MV,R
 *6 :,BLOCK,PD,TP,JN,E ,F
 *6 :,BLOCK,RO,RG(2),RT
 *11:,BLOCK,P ,W ,J ,M ,S
 *11:,BLOCK,L(2) ,IF,B ,RD
 *14:,BLOCK,         C
C
C
C******   BXOД B ЗAДAЧY OT ЭK70
C
C   ------------------------------
C   PAЗPЯДЫ  I W 7 0   ДЛЯ  MБ :
C   ------------------------------
C     1-5  - HOMEP TPAKTA
C     7-8  - HOMEP CEKTOPA
C     ( ПPИ '1' B 36-M PAЗPЯДE IW70
C      HOMEP CEKTOPA ЗAДAETCЯ B 1-2 P.
C      A HOMEP TPAKTA - B 3-7 P. )
C     13-17  - HOMEP MБ
C     25-26  - HOMEP AБЗAЦA
C     31-35  - HOMEP ЛИCTA
C       39    - ФИЗИЧECKИЙ OБMEH
C       40    - ЧTEHИE
C       48    - CEKTOPHЫЙ OБMEH
C
C
C   ------------------------------
C   PAЗPЯДЫ  I W 7 0   ДЛЯ  MЛ :
C   ------------------------------
C     1-12  - HOMEP ЗOHЫ
C     13-18  - HOMEP MЛ
C     31-35  - HOMEP ЛИCTA
C       39    - ФИЗ. OБMEH
C       40    - ЧTEHИE
C       41    - ПOДBOД
C       42    - ЧTEHИE ИMEHИ
C       43    - PAЗMETKA MЛ EC B PEЖ. EC
C       44    - PAЗMETKA MЛ EC B PEЖ. БЭCM-6
C       46    - ПPИЗHAK MOДEЛИ ФИЗ. MЛ
C              (B ЭTOM CЛYЧAE HOMEP MЛ -
C              - БAPAБAHHЫЙ )
C   ------------------------------
C   ------------------------------
C
C
C   PAЗPЯДЫ  KYC-A  OБMEHA C MБ :
C----------------------------------
C
C   1-2  - HOMEP CEKTOPA
C   3-7  - HOMEP TPAKTA
C   8-10 - HOMEP MБ
C  11-12 - HOMEP AБЗAЦA
C  13-17 - HOMEP ЛИCTA
C    18   - ЧTEHИE
C    19   - ЛИCTOBOЙ OБMEH
C    21   - ЧTEHИE CЛ.CЛOB
C  24-25 - HOMEP CEГMEHTA MOЗY
C    27   - БЫЛA TT-ПEЧATЬ ДИAГHOCTИKИ
C    38   - ЗAKAЗ OT TRAPHY
C    39   - ФИЗ.OБMEH OT Э70
C  40-42 - HOMEP HAПPABЛEHИЯ
C  43-48 - Д H З
C----------------------------------
C
C
C   PAЗPЯДЫ  KYC-A OБMEHA C MЛ :
C----------------------------------
C
C    1   - ПPИЗHAK HAЧAЛЬHOЙ OPИEHTAЦИИ
C    2   - БЫЛO ЧTEHИE CЛ.CЛOB
C          (COCTOЯHИE 1 И 2 PAЗPЯДOB
C           BCEГДA Д.Б. OДИHAKOBЫM )
C    3   - ЛEHTA CTOИT ПЛOXO
C          (B ПPOMEЖYTKE MEЖДY ЗOHAMИ)
C    4   - HET CMOTKИ HA HAЧAЛO
C    5   - ЧTEHИE ИMEHИ
C    6   - ПOДBOД
C    7   - БЫЛA ДИAГHOCTИKA HA TT
C   8-10 - HOMEP MФ
C    11  - ЗAKAЗ ГOTOB K BЫБPOCY
C   12  - PAБOTAEM C ДYБЛEM ЗOHЫ
C          (ДЛЯ PAЗMETKИ MЛ EC)
C  13-17 - HOMEP ЛИCTA
C    18   - ЧTEHИE
C  19-20 - ДЛЯ PAЗMETKИ MЛ EC
C          ('1'-ЗAПИCЬ MГЗ, '2'-ШЗH
C          '3'-ЗAПИCЬ ЗOHЫ, '0'-HOPM.OБMEH)
C   21   - ЧTEHИE CЛ.CЛOB
C   22   - БЛOKИP.ЧTEHИЯ CЛOB C OШИБKAMИ
C   23   - ЧTEHИE C HAЛOЖEHИEM
C  24-25 - HOMEP CEГMEHTA MOЗY
C  26-36 - HOMEP ЗOHЫ
C   37   - ПOBTOPHЫЙ OБMEH
C   38   - ЗAKAЗ OT TRAPHY
C   39   - ФИЗ.OБMEH OT Э70
C  40-42 - HOMEP HAПPABЛEHИЯ
C  43-48 - Д H З
C
C----------------------------------
C
C    BXOД OT 70 ЭKCTPAKOДA
C
C----------------------------------
 MACSTART:,BSS,
 ,XTA,
 ,ATX,KYC
 ,ATX,KPAGE.ДЛЯ ЧT.ИM.
 ,XTA,BIT48
 ,ATX,SECT
 ,XTA,CWJFOTRA
 ,AAX,B48/43
 ,ATX,KSJN. Д H З
 ,ASN,64+42.ЗAKAЗЧИKA
 ,ATI,JN
C..  XAPAKTEPHЫE БИTЫ   I W 7 0
C..  PACTAЩИM B ИHДEKC-PEГИCTPЫ :
C     CT - ФИЗ.ПAKET (CLOSE TASK)
C     NR - ЧTEHИE ИMEHИ
C     MV - ПOДBOД
C     RD - ЧTEHИE
C     PD - ФИЗ.OБMEH
C     TP - MЛ
C=================================
 ,XTA,IW70
 ,ARX,BIT16
 ,APX,RBITSM
 ,ASN,64+NRBS
 ,ATX,RBITS
 M,VTM,1-NRB
 SETREG:,BSS,
 ,XTA,RBITS
 M,AAX,BIT1
 M,ATI,NRB
 M,VLM,SETREG
 U,J+M,TP
 R,MTJ,RD
 ,XTA,IW70
 ,ASN,64+12
 ,AAX,C77
 ,ATI,U.HOMEP YCTP-BA
 ,XTA,IW70
 ,AAX,C7777
 ,ATX,DISAD.HOMEP ЗOHЫ
 R,VTM,PDIMAC
 TP,V1M,TAMAC
 R,VJM,CLOPM70
 ,XTA,IW70
 ,APX,MDRADM. 37 0037
 ,ATX,KYC
 PD,V1M,PDRMAC
C
C...   OБMEH C MAT.MБ
C
 ,ASN,64+38
 ,AEX,KSJN
 ,ATX,DRIDENT
 RG,CALL,GIVTRACK
 ,ATX,KYC.ФИЗ.AДPEC
 M,V1M,MSETSEC
 RD,VZM,MSETSEC
C
C...   ПEPBOE OБPAЩEHИE - ПO ЧTEHИЮ
C      OБHYЛЯEM CEKTOP ИЛИ ЛИCT
C      ЗAMEHИM ЧTEHИE HA ЗAПИCЬ.
C
 RD,VTM,-1777B
 ,XTA,KPAGE
 R,VJM,PRIPTRA
 ,XTA,IW70
 ,ARX,
 ,U1A,SETZ
 RD,VTM,-377B
 ,AEX,BIT48
 ,ATX,IW70
 ,ASN,64+16
 ,AAX,C1400
 ,ATI,M
 SETZ:,BSS,
 :,24,2
 ,XTA,
 M,ATX,70000B
 M,UTM,1
 :,24,3
 RD,VLM,SETZ
 MSETSEC:,BSS,
 ,XTA,IW70
 R,VTM,CHMODRU
 SETSECT:,BSS,
 ,ARX,
 R,U1A,
 ,AEX,BIT48
 ,APX,MS/70
 ,ATX,SECT
 R,UJ,
C
C----------------------
C
  TRASWI:,ENTRY,
C
C***   BXOД OT ПOДKAЧKИ ПO И10.
C      B IW70 - ПPOДYKЦИЯ GIVTRACK-A
C      И.P. 4 - ФИЗ.HOMEP ЛИCTA.
C
 ,XTA,IW70
 ,ATX,KYC
 ,ASN,64+17
 ,AAX,BIT1
 ,ATI,RD
 ,XTA,BIT48
 ,ATX,SECT
 PD,VTM,
 CT,VTM,
  ,ITA,10
  ,ATX,QUEONLY.BOЗBPAT
 ,XTA,CWJFOTRA
 ,AAX,B48/43
 ,ATX,KSJN. Д H З
 ,ITA,4
 ,ASN,64-41
 ,AUX,KPMASK
 ,ATX,KPAGE.ФИЗ.ЛИCT
 4,XTA,TPHYS
 ,APX,MMNTPL
 ,ASN,64+36
 ,ATI,P.MAT.ЛИCT
 R,VJM,CLOPSWI
C
C...   ПPOБA: "TPAKT MБ" BЫДEЛEH
C      B SCRATCH - OБЛACTИ
C
 CHMODRU:,BSS,
 ,XTA,KYC
 ,ARX,
 ,U1A,PHDRUM .-HET
 ,ASN,64+2
 ,ATX,DISAD.HOMEP "TPAKTA"
 ,XTA,KYC
 ,APX,KUNITM
 ,ASN,64+42
 ,ATI,B.HOMEP ЭKCTEHTA
 W,VTM,-LTS
 ,UJ ,SASEAR
C
C...   OБMEH C ФИЗИЧECKИM MБ
C
 PDRMAC:,BSS,
 ,XTA,IW70
 R,VJM,SETSECT
C...   ПPOБA ПEPEAДPECAЦИИ MБ-MД
 R,VJM,CHMODSY
C...   ПPOБA ПOДMEHЫ MБ 21-22 HA MБ
 U,UTM,-21B
 ,ITA,U
 ,ASN,64+1
 ,U1A,NOSUBS
 ,XTA,IW70
 ,AAX,C37
 U,AOX,*DR2122
 ,APX,MDRADM
 ,ATX,KYC
 NOSUBS:,BSS,
 ,XTA,KYC
 ,AUX,KDRADM
 ,ATX,KYC
C
C...   ПOCTAHOBKA MБ-OБMEHA B OЧEPEДЬ
C
 PHDRUM:,BSS,
 ,XTA,SECT
 ,AUX,MS/KYC
 :RD,VZM,*+1
 ,AOX,B22*18
 ,AOX,KYC
 RT,VJM,DTASKON
 ,XTA,BIT1
 ,ARX,MДMЛMБ.CЧETЧИK
 ,ATX,MДMЛMБ.MБ-OБMEHOB
 L,XTA,BIT48
 C,AOX,SRJC-1
 C,ATX,SRJC-1
C
C...   ECЛИ MБ-KAHAЛ CBOБOДEH
C      И ЗAKAЗ HE OT ПOДKAЧKИ
C      TO CPAЗY И BЫПOЛHИM.
C
 ,ACX,
 ,ASN,64+1
 ,AOX,QUEONLY
 RT,VTM,ENDMAC70
 L,UTM,1
 L,MTJ,N
 ,UZA,CONTEXCH
 RT,UJ ,
C
C...   Э070 ЛEHTOЧHOГO TИПA
C
 TAMAC:,BSS,
 CT,V1M,CLOPM70.ФИЗ.ДИCK
 ,XTA,IW70.ПOДГOTOBKA
 ,AAX,B24/1.ИДEHTИФИKATOPOB
 ,AOX,KSJN.ДЛЯ ПOИCKA
 ,APX,DIDM.ПO TAБЛИЦAM
 ,ATX,IDENT.TIMT,FATA
 ,XTA,RBITS
 ,ASN,64+2
 ,AAX,C7
 ,ATI,RD.R.OR.MV.OR.NR
 ,ASN,64+1
 E,VTM,ЧYЖAЯ MЛ
 ,U1A,CHPHYTA.MV.OR.NR
 R,VTM,CHPHYTA
 PD,V1M,CLOPM70
 IF,XTA,PЛД.CTATYC
 U,AAX,BIT48-30B."C ЗAKPЫTИEM
 ,UZA,CLOPM70.ЗAДAЧИ"
 CT,VTM,1. - ДA
C
C...  PAЗБOP: ЗAKPЫTЬ ЗAДAЧY
C     ИЛИ TOЛЬKO EE MAT.ЛИCT
C
 CLOPM70:,BSS,
 ,XTA,IW70
 ,ASN,64+30
 ,AAX,C37
 ,ATI,P.HOMEP ЛИCTA
 IF,UTC,
 P,XTA,TMATH
 ,ASN,64-11
 ,AUX,KPMASK
 ,UZA,BADEXCH
 ,ATX,KPAGE.ФИЗ.ЛИCT
 R,UTC,.ПPOЙДEM
 CT,V1M,.ЧEPEЗ "CLOTA"
C
C...   ПOДПPOГPAMMA ЗAKPЫTИЯ
C      MAT.ЛИCTA ПO ПPИПИCKE
C          И ЗAЩИTE
C
 CLOSPAGE:,ENTRY,
 ,XTA,FULWOR.CHИMAEM
 P,AEX,BIT48.ПPИЗHAK
 IF,AAX,ST/EXCH."ПЛOXOЙ
 IF,ATX,ST/EXCH.OБMEH"
 CLOPSWI:,BSS,
 ,ITA,P
 ,ASN,64+5
 R,U1A,.ФOPM.ЛИCT
 ,ITA,P
 ,ASN,64+3
 ,AEX,C3
 ,ATI,W
 ,ITA,P
 ,AAX,C7
 ,AEX,C7
 IF,J+M,W
 ,ATI,B
 B,XTA,BIT28
 W,AOX,TЗAЩ
 W,ATX,TЗAЩ
 ,ITA,P
 ,ASN,64+2
 ,AEX,C7
 ,ATI,W
 ,ITA,P
 ,AAX,C3
 IF,J+M,W
 ,ATI,B
 B,XTA,TMPMASK
 ,AEX,FULWOR
 W,AAX,TПPИП
 W,ATX,TПPИП
 R,UJ,
C
C...   OПPEДEЛEHИE TИПA YCTPOЙCTBA
C      (MAT., ФИЗ., ЛEHTA, ФAЙЛ)
C
 CHPHYTA:,BSS,
 PD,V1M,PTAMAC.ФИЗ.HOMEP
 F,VTM,LTF+1
 IF,XTA,MЛД
 U,AAX,BIT48-30B
 ,U1A,FIMAC.ФAЙЛ
 W,VTM,-57B
C
C...   ПOИCK ЛOГИЧECKOГO ИДEHTИФИKATOPA
C      ( ДHЗ + MAT.HOMEP )   B T1MT
C
 MTSEAR:,BSS,
 W,XTA,T1MT+37B
 ,AEX,IDENT
  ,AAX,MASK12
 ,UZA,CHWPTA.ECTЬ ЛEHTA
 W,VLM,MTSEAR
 ,UJ ,FIMAC.A BДPYГ ФAЙЛ?
 PTAMAC:,BSS,
 ,XTA,ШФЛД
 U,AAX,BIT48-10B
 ,U1A,MODTAP
 TP,UTM,-100B.OШ.HOMEP
 TP,VZM,ERTREQ.MOДEЛИ
 ,UJ ,PHTAPE
C
C...   ПPOБA: PAЗPEШEHA ЛИ
C      ЗAПИCЬ HA ЛEHTY
C
 CHWPTA:,BSS,
 W,UTM,67B
 E,VTM,ЗAПPET ЗП
 RD,V1M,CHMODTA
 ,XTA,ЗAKЗAП
 W,AAX,BIT48-10B
 ,UZA,ERTREQ
 CHMODTA:,BSS,
 W,MTJ,U
 ,XTA,ШФЛД
 U,AAX,BIT48-10B
 ,U1A,MODTAP.ЛEHTA-MOДEЛЬ
C
C...   ФOPMИPOBAHИE KYC-A ДЛЯ ЛEHTЫ
C
 PHTAPE:,BSS,
 U,XTA,T1MT-30B
  ,ASN,64+12
  ,ARX,DISAD. + ДEЛЬTA
  ,ARX,BIT3. + 4
  ,AAX,C3777.YДBOEHИE
  ,ASN,64-25.HOMEPA ЗOHЫ
 ,ATX,KYC
 ,ITA,U
 ,ASN,64-42
 ,AUX,KUNITM
 ,AOX,KSJN
 ,AOX,KYC
 R,VTM,
 NR,J+M,CT
 :MV,VZM,*+1
 R,VTM,BITMOV
 :NR,VZM,*+1
 R,VTM,BITNAM
 R,AOX,
 R,V1M,TCLOTA
 ,ATX,KYC
 ,XTA,IW70.БИTЫ 44-43
 ,ASN,64-4. - PAЗMETKA
  ,AUX,B19*12.MЛ EC
 :,UZA,*+1
 ,AOX,BIT11
 ,AOX,KPAGE
 ,AOX,KYC
C
C...   ПPOБA: HE ЗAKPЫTЬ ЛИ ЗAДAЧY
C
 TCLOTA:,BSS,
 :CT,VZM,*+1
 CT,VJM,CLOTA.ЗAKPЫTЬ
 :PD,VZM,*+1
 ,AOX,BIT39
 CHRDTA:,BSS,
 :RD,VZM,*+1
 ,AOX,B22*18
 ,ATX,KYC
 ,XTA,
 RD,V1M,TTASKON
C
C...   ПOЛYЧEHИE KOHTPOЛЬHOЙ CYMMЫ
C      ПPИ ЗAПИCИ ЗOHЫ HA ЛEHTY
C
 J,VTM,-1777B
 ,XTA,KYC
 R,VJM,PRIPTRA
 :,24,2
 ,XTA,
 LSTAPE:,BSS,
 J,ARX,71777B
 J,VLM,LSTAPE
 TTASKON:,BSS,
 :,24,3
 RT,VJM,TASKON.B OЧEPEДЬ
 EPHTAP:,BSS,
 ,XTA,BIT25
 ,ARX,MДMЛMБ.CЧETЧИK
 ,ATX,MДMЛMБ.MЛ-OБMEHOB
 L,XTA,BIT48
 U,AOX,SJMT-30B
 U,ATX,SJMT-30B
C
C...  ПOCTAHOBKA PAБOTЫ ПO ЛEHTE
C     B ШKAЛY PAБOT ЗAДAЧИ OБMEHA
C
 :,24,2003B
 ,XTA,TRABUS
 C,AAX,BIT44-3
 ,U1A,ENDMAC70.YЖE ECTЬ
 ,XTA,BIT40
 C,AOX,BIT44-3
 ,AEX,TRABUS
 ,ATX,TRABUS
 C,XTA,BIT36-3
 ,CALL,CLOMIR
 :,24,3
 ,UJ ,ПPOДPAБ
C
C...   OБMEH C ФИЗИЧECKИM ДИCKOM
C
 PDIMAC:,BSS,
 ,XTA,IW70
 ,ASN,64-30
 ,AUX,KUNITM
 ,ATX,DID
 ,XTA,IW70
 ,ASN,64+24.K O П
 ,AOX,BIT5
 ,AAX,C77
 PHDISC:,BSS,
 ,AOX,DID
 ,ATX,KYC
 ,XTA,DISAD
 ,ARX,BIT4
 ,AAX,C7777
 ,ASN,64-25."ЗOHA"
 ,AOX,KYC
 ,AOX,BITPAG
 :CT,VZM,*+1
 CT,VJM,CLOTA
 :RD,VZM,*+1
 ,AOX,BITRD
 ,ATX,KYC
 ,XTA,SECT
 ,AEX,BIT48
 ,UZA,DPAGEX
 ,AEX,BIT48
 ,ASN,64+24
 ,AOX,BDSEC
 DPAGEX:,BSS,
 ,AOX,KYC
 RT,VTM,DAFSET
 DTASKON:,BSS,
 ,AOX,KSJN
 ,AOX,KPAGE
 :PD,VZM,*+1
 ,AOX,BIT39
  :,ATX,KYC
  ,APX,KPMASK
  ,ASN,64+41.БИT 6 B TPHYS -
  ,ATI,L. - ПPИЗHAK, ЧTO
  ,XTA,BIT6.ЛИCT ЗAHЯT B OБMEHE
  L,AOX,TPHYS.C MБ ИЛИ MД.
  L,ATX,TPHYS
 ,XTA,
 RD,V1M,TASKON
C
C...   KOHTPOЛЬHOE CYMMИPOBAHИE ДЛЯ MД/MБ
C
 L,VTM,1-4
 ,XTA,KYC
 R,VJM,PRIPTRA
  M,VTM,
 ,XTA,SECT
 ,ARX,
 ,UZA,LSPAG
 ,ASN,64+37
 ,AAX,C1400
   ,ATI,M
 L,VTM,
 ,XTA,
 LSPAG:,BSS,
 ,ASN,64-12
 ,ATX,WLSUM
 ,XTA,
 :,24,2
 J,VTM,-377B
 LSSEC:,BSS,
  M,ARX,70000B
 M,UTM,1
 J,VLM,LSSEC
 :,24,3
 J,VJM,S48TO12
 ,AOX,WLSUM
 L,VLM,LSPAG
 TASKON:,ENTRY,
 TASKON:,BSS,
 ,WTC,TRACNT
 L,VTM,
 L,ATX,WL2
 ,ITA,L
 ,ARX,C1
 ,ATX,TRACNT
 ,XTA,KYC
 L,ATX,WL1
 ,ASN,64+39
 ,AAX,C7
 ,ATI,C
 ,XTA,
 ,ATX,KYC
  ,XTA,QUEONLY
  RT,UZA,
  L,XTA,BIT48
  ,AOX,SCSWING
  ,ATX,SCSWING
  ,XTA,
  RT,UJ,
C
C...   ПOИCK ЛOГИЧECKOГO ИДEHTИФИKATOPA
C          B TAБЛИЦE ФAЙЛOB
C
 FIMAC:,BSS,
 F,UTM,-1
 F,VZM,ERTREQ.HE HAШЛИ
 F,XTA,FATA-1
 ,AEX,IDENT
  ,AAX,MASK12
 ,U1A,FIMAC
C
C...         ФAЙЛ HAЙДEH
C      ЧTEHИE ИMEHИ - BЫДAДИM 0
C      ПOДBOД - ПPOИГHOPИPYEM
C
 NR,V1M,SETACC
 MV,V1M,ENDMAC70
 U,XTA,BIT48-30B.ЧTOБЫ HE
 IF,AOX,MЛД.ИCKATЬ B T1MT
 IF,ATX,MЛД.B ДPYГOЙ PAЗ
 ,XTA,DISTIME
 IF,A+X,BISTIME
 IF,ATX,BISTIME
 F,XTA,FATA-1
 ,AAX,B36/31
 E,VTM,ЗAKPAБMД
 ,UZA,TDISEAR.SCRATCH-ФAЙЛ
C
C...   ИЗBЛEЧEHИE HOMEPA MOДYЛЯ
C      ИЗ TAБЛИЦЫ ФAЙЛOB
C
 CHESCR:,BSS,
 F,XTA,FATA-1
 ,ASN,64-12
 ,AUX,KUNITM
 ,UZA,BADEXCH
 ,ATX,DID
 RD,V1M,CHDISAD
 E,VTM,ЗAПPET ЗП
 F,XTA,FATA-1
 ,AAX,BITWP
 ,UZA,ERTREQ
C
C...   KOHTPOЛЬ BЫXOДA ЗA ГPAHИЦY ФAЙЛA
C
 CHDISAD:,BSS,
 F,XTA,FATA-1
 ,ASN,64+12
 ,AAX,C7777
 ,ARX,DISAD
 ,ATX,DISAD
 F,XTA,FATA-1
 ,AAX,C7777
 ,NTR,3
 ,A-X,DISAD
 E,VTM,ЧYЖ TPEK
 ,U1A,ERTREQ
 F,XTA,FATA-1
 ,ASN,64-20
 ,AUX,C50
 ,UJ ,PHDISC
C
C...   OБMEH CO SCRATCH-ФAЙЛOM
C
C      ПOИCK B TAБЛИЦE ЭKCTEHTOB
C
 TDISEAR:,BSS,
  ,XTA,IDENT.YЖИMAHИE
  ,ARX,SCR*D.ДHЗ И MN
  ,APX,SCR*P.ДO 5 БИT
  ,ATX,IDENT
  ,ASN,64+16
  ,AOX,IDENT
  ,ASN,64+16.YTPOEHИE
  ,AOX,IDENT.ИДEHTИФИKATOPA
  TDS1:,BSS,
 W,VTM,-LTD
  ,ATX,DID
 SEW:,BSS,.ПO CЛOBAM
 W,AEX,TDIS+LTD
 B,VTM,1-3
 SEB:,BSS,.ПO ЭKCTEHTAM
 ,ASN,64-16
 ,ATX,WS
 ,YTA,
 ,UZA,GLOBYTE.HAШЛИ
 ,XTA,WS
 B,VLM,SEB
 ,XTA,DID
 W,VLM,SEW
C...   ECЛИ HET CBOБOДHOГO MECTA
C      B TAБЛ.ЭKCTEHTOB - БYДEM
C      BЫШИБATЬ ЮЗEPA !!!
 F,XTA,FATA-1.SCRATCH
 ,AAX,C3777.ЮЗEPA
 ,UZA,ERTREQ.ИCЧEPПAH
 F,XTA,FATA-1
 ,ARX,C3777.YMEHЬШAEM
 ,AEX,BIT12.ЛИMИT
 F,ATX,FATA-1
 ,XTA,.И BOЗЬMEM
  ,UJ,TDS1.CBOБ.ЭKCTEHT
C
C...   ЗAXBAT ЭЛEMEHTA
C     B TAБЛИЦE ЭKCTEHTOB
C
 GLOBYTE:,BSS,
 ,ITA,B
 ,ASN,64-4
 ,ATI,R
 ,XTA,IDENT
 R,ASN,64+32
 W,AOX,TDIS+LTD
 W,ATX,TDIS+LTD
 B,UTM,LTD*3+2
 W,J+M,B
 W,J+M,B
 W,J+M,B
 W,VTM,-LTS
C
C...   ПOИCK ЗAXBAЧEHHOГO ЭKCTEHTA
C      B TAБЛИЦE SCRATCH-OБЛACTEЙ
C
 SASEAR:,BSS,
 B,MTJ,R
 W,WTC,TSF+LTS
 B,UTM,1
 ,ITA,B
 ,AAX,BIT15
 ,U1A,SETFAD
 W,VLM,SASEAR
 ,UJ ,BADEXCH
 SETFAD:,BSS,
 ,ITA,R
 ,ASN,64-5
 ,ATX,DID
 W,XTA,TSF+LTS
 ,ASN,64+15
 ,UJ ,MODSYS
C
C...   ПEPEAДPECAЦИЯ ФИЗ.БAPAБAHOB
C      16,17,21,22  HA ДИCK
C
 CHMODSY:,BSS,
  U,XTA,BIT48-10B
  ,APX,DISPMD
  ,UZA,CHMODSY1
  ,AAX,BIT48
  :,U1A,*+1.1-Й MБ (16)
  ,XTA,DSHIFT.2-Й MБ (17)
 :,AAX,C7777
  ,ARX,DISPMD
  E,VTM,DISPMD - SYSMD
  ,UJ,MAKDID
  CHMODSY1:,XTA,Ш/ДИCП
 JN,AAX,BITS
  R,U1A,
 U,XTA,BIT48-10B
 IF,APX,SYSMD
 R,UZA,
 ,ANX,B24/1
 ,ASN,64-5
 IF,ARX,SYSMD
  IF,MTJ,E
  MAKDID:,BSS,
 ,AAX,C7777
 ,ATX,DID
  E,XTA,SYSMD
 ,ASN,64+12
 MODSYS:,BSS,
 ,ATI,F
 ,XTA,DISAD
 ,AAX,C37
 ,ARX,DID
 ,ATX,DISAD
 ,UJ ,CHESCR
C
C...   ЗAKAЗ AДPECOBAH K MOДEЛИ MЛ
C
 MODTAP:,BSS,
 NR,V1M,MODNAM
 MV,V1M,ENDMAC70
 MODTEX:,BSS,
 U,XTA,T1MT-30B
 ,ASN,64+12. + ДEЛЬTA
 ,ARX,DISAD
 ,AAX,C7777
 ,ATX,DISAD
 U,XTA,T2MT-30B.ИHДEKC ПO
 ,ATI,F.TAБЛИЦE ФAЙЛOB
 ,UJ ,CHESCR
 MODNAM:,BSS,
 U,XTA,TANAMEMT-30B
 SETACC:,BSS,
 IF,ATX,
 ,UJ ,ENDMAC70
C
C
C...   ДИCПETЧEPCKИЙ BXOД
C      B ЗAДAЧY OБMEHA
C       И14 - BOЗBPAT
C       И13 - AДPEC KYC-A
C      PEЗYЛЬTAT - B SAVAC
C
 TRAPHY:,ENTRY,
 TRAPHY:,BSS,
 :,24,2003B
 ,RTE,177B
 ,ATX,SAVSR
 ,ITA,S
 S,VTM,SAVI15
 ,ITS,M
 ,ITS,J
 ,XTS,DISREG
 ,ATI,27B
 ,XTA,TRACNT
 ,ARX,MTRACNT
 ,UZA,FULQUE
 ,XTA,ГYC
 ,AAX,B48/43
 J,AOX,
 ,ATX,KYC39.ДOБABKA ДHЗ
 ,XTA,TRABUS
 ,UZA,FRETRA
 ,AOX,BIT39
 ,UJ ,SETBUS
 FRETRA:,BSS,
 ,XTA,KYC39
 ,ATX,KYC40
 ,XTA,BITTRA
 ,AOX,RDSCAL
 ,ATX,RDSCAL
 ,XTA,DISREG
 ,ATX,IFTRA+S27
 ,XTA,ADREQ40
 ,ATX,IFTRA+S33."ФИЗOБM1"
 ,XTA,BIT40
 SETBUS:,BSS,
 ,ATX,TRABUS
 ,UJ ,ETRAPH
C
C...ЗAKPЫTИE KЛИEHTA, ECЛИ OЧEPEДЬ ПOЛHA
C
 FULQUE:,BSS,
 M,VTM,TRAPHY
 ,XTA,BITJ
 ,AOX,FULQUESC
 ,ATX,FULQUESC
 ETRAPH:,BSS,
 M,MTJ,33B
 ,UJ ,CLANEWTA
C
C...   PAБOTA TRAM70 OT 39 P. TRABUS
C      (ИЛИ OT 40, ECЛИ БЫЛA CBOБOДHA)
C
 ФИЗOБM1:,BSS,. OT 39
 ,XTA,KYC39
 ,ATX,KYC40
 ,XTA,TRABUS
C   ПPИ ДOБABЛEHИИ HOBЫX PAБOT
C   CMEHИTЬ AДPEC B CЛEД.KOMAHДE!
 ,AAX,BIT38.!!!
 ,AOX,BIT40.ДЛЯ ПPABИЛЬHOЙ
 ,ATX,TRABUS.PAБOTЫ ENDMACRO
C
 PHYREQ40:,BSS,. OT 40
 ,XTA,KYC40
 ,AAX,KPMASK
 ,ATX,KPAGE
 ,XTA,KYC40
 ,AAX,B48/43
 ,ATX,KSJN
 ,ASN,64+42
 ,ATI,JN
 JN,WTC,*YCЫ
 IF,VTM,
 PD,VTM,
 ,XTA,BIT48
 ,ATX,SECT
 ,XTA,KYC40
  CT,VJM,CLOTA. + BIT38 = KYC
 ,ASN,64+17
 ,AAX,BIT1
 ,ATI,RD
 ,XTA,KYC
 ,APX,KUNITM
 ,ASN,64+42
 ,ATI,U
 ,ASN,64+3
 ,ATI,C
 ,XTA,KYC
 C,VZM,DIPREQ
 C,UTM,-7
 C,VZM,NSPREQ
 ,AAX,BIT39
 ,U1A,MODPREQ
 ,ITA,C
 ,AAX,BIT3
 ,U1A,TAPREQ
 R,VTM,PHDRUM
 ,XTA,KYC
 ,ASN,64+2
 ,ATX,DISAD
 ,AAX,BITPAG+2
 ,U1A,CHMODSY
 ,XTA,KYC
 ,APX,MS/KYC
 ,ATX,SECT
 ,UJ ,CHMODSY
 TAPREQ:,BSS,
 ,XTA,KYC
 ,UJ ,CHRDTA
C
C...  "7" B 40-42 P.  KYC-A  TRAPHY
C   - ЗAKAЗ OT HECTAHДAPTHOГO ДPAЙBEPA.
C   ПPИ ЭTOM B 1-15 P. - AДPEC MACCИBA
C   ИЗ 2 CЛOB :
C  1 : HACTOЯЩИЙ KYC (ПPИ OБMEHE ЛИCT HE 0)
C  2 : AДPECA ПPOЦEДYP ПYCKA И KOHЦA
C   AДPECA ПOMEЩAЮTCЯ B WL2.
C   KYC CHAБЖAETCЯ ДHЗ B 48:43 PAЗP.,
C   "1" 38 P. И ПOMEЩAETCЯ B  WL1.
C
 NSPREQ:,BSS,
 ,ATI,M
 M,XTA,
  ,AOX,KSJN
  ,AOX,BIT38
 ,ATX,KYC
 ,APX,KUNITM
 ,ASN,64+42
 ,ATI,U
 M,XTA,1
  ,AOX,KSJN
 RT,VJM,TASKON
 L,XTA,BIT48
 ,AOX,БYPЖYЙ
 ,ATX,БYPЖYЙ
 L,XTA,WL1
 ,AAX,KPMASK
 ,UZA,EPHTAP
 L,XTA,BIT48
 C,AOX,SRJC-1
 C,ATX,SRJC-1
 ,UJ ,EPHTAP
 DIPREQ:,BSS,
 ,ASN,64+11
 ,AAX,BIT1
 ,ARX,C3
 ,ASN,64-39
 ,UJ ,DPAGEX
 MODPREQ:,BSS,
 ,XTA,KYC
 ,ASN,64+25
 ,ARX,C77774
 ,ATX,DISAD
 ,UJ ,MODTEX
C
C...  ЗAKPЫTИE ЗAДAЧИ, ПOДABШEЙ OБMEH.
C
 CLOTA:,BSS,
 ,AOX,BIT38
 ,ATX,KYC
 :,24,2003B
 JN,XTA,BITS
 ,AEX,FULWOR
 ,AAX,RDSCAL
 ,ATX,RDSCAL
 ,XTA,KYC
 :,24,3
 CT,UJ ,
C
C...  ПPИПИCKA ЛИCTA ИЗ KYC-A OБMEHA
C     K 34 MAT.ЛИCTY ЗAДAЧИ OБMEHA
C
 PRIPTRA:,ENTRY,
 PRIPTRA:,BSS,
 ,APX,KPMASK
 ,ATX,RRR
 ,UZA,BADEXCH
 ,AUX,TMPMASK
 ,ATX,IFTRA+TПPИП
 ,ATX,SWINGIF+TПPИП
 ,ITA,R
 R,VTM,-8
 :,ATX,1
 R,VLM,*
 ,ATI,R
 ,XTA,RRR
 ,AUX,PПMASK
 ,MOD,27B
 ,ATI,
 R,UJ,
C
C...  CBEPTKA 48-PAЗPЯДHOЙ KOHTPOЛЬHOЙ
C     CYMMЫ B 12-PAЗPЯДHYЮ
C
 S48TO12:,ENTRY,
 S48TO12:,BSS,
  ,ATX,FSUM
  ,XTA,
  ,ATX,RSUM
  ,XTA,FSUM
  COMPR:,ASN,64+12
  ,ATX,FSUM
  ,YTA,
  ,ARX,RSUM
  ,ATX,RSUM
  ,XTA,FSUM
  ,U1A,COMPR
  ,XTA,RSUM
  ,ASN,64+36
  ,ARX,RSUM
  ,AAX,C7777
 J,UJ ,
C
C...   БЫЛИ OШИБKИ B ЗAKAЗE HA OБMEH
C
 ERTREQ:,BSS,
 ,ITA,E
 IF,ATX,I14
 IF,XTA,S33
 IF,ATX,COPYS33
 M,VTM,ERRPRI
 ,ITA,M
 IF,ATX,S33
 ,XTA,DISREG
 IF,ATX,S27
 MV,J+M,NR
  N,VTM,.БEЗ TASKOFF
 ,XTA,KYC
 ,AOX,KPAGE
  IF,ATX,.CYMM.=KYC
  ,ATX,OFFKYC
 ,AAX,BIT38
 ,U1A,OPEN
  ,XTA,IW70.CYMM.=IW70
  IF,ATX,
 NR,V1M,ENDMAC70
  ,UJ ,OPEN
C
C
 MSKADRMD:,EQU,KDRADM
 CON14:,EQU,KUNITM
 CBEPKCYM:,EQU,S48TO12
 ПPИПOБME:,EQU,PRIPTRA
 CONTEXCH: ,ENTRY,
C
C*********          BXOД: BЫПOЛHEHИE ЗAKAЗA, YЖE ПOCTABЛEHHOГO B OЧEPEДЬ
C
  CONTEXCH:,24,2003B
  12,XTA,WL2-1
  14,ATX,CSUM-1
  12,XTA,WL1-1
  14,ATX,TBUC-1
  14,ATX,TBUT-1
  9,UZA,
 13,VJM,CHPOP.P-OПEPAЦИЯ
 9,UTC,
 15,V1M,.CEMAФOP ЗAKPЫT
  12,XTA,BITS
  14,ATX,SBUC-1
 EXCHMБ:,BSS,
 14,XTA,TBUC-1
 ,AAX,ЧTEHИE
  ,UIA,BЫT
C.........ФOPMИPOBAHИE CЛYЖEБHЫX CЛOB ДЛЯ ЗAПИCИ HA MБ (TPAKTA)
C         (ЧETHЫE CЛYЖ. CЛOBA - AДPECA CEKTOPOB, HEЧETHЫE - KC)
 14,XTA,TBUC-1
 ,AAX,C3
 ,ASN,64-1
 14,ARX,BC1700
  ,ATI,13
 14,XTA,TBUC-1
  13,ATX,
 ,AAX,ЛИCTOБM.
 ,UZA,MБЗAП1C.
 14,XTA,TBUC-1
 ,ARX,BIT1
  13,ATX,2
 ,ARX,BIT1
  13,ATX,4
 ,ARX,BIT1
  13,ATX,6
 14,XTA,C SUM-1
 WR KS:,ASN,64-12.
 ,ATX,WS
 ,YTA,
   13,ATX,1
  13,UTM,2
  ,ITA,13
 ,AAX,C7
 ,UZA,BЫT
 ,XTA,WS
 ,UJ,WR KS
  BЫT:13,VTM,-7
 :,ATX,1.
  13,VLM,*
C.........BЫДAЧA KOMAHДЫ OБMEHA C MБ
 ,XTA,BIT3.
 14,ATX,TMБ-1.
 14,XTA,TBUC-1
          14,  EXT  ,               .
            ,  ATI  ,               .
  14,XTA,BIT47
  9,MTJ,13
  ,UJ,PERMIR
 MБЗAП1C:,BSS,.
C.........ФOPMИPOBAHИE CЛYЖEБHЫX CЛOB ДЛЯ ЗAПИCИ HA MБ (CEKTOPA)
 14,XTA,C SUM-1.
 ,AAX,C7777.
  13,ATX,1
 ,UJ,BЫT.
C
C
C...   KOHEЦ PAБOTЫ ЗAДAЧИ OБMEHA
C      ПO ПPИEMY ЗAKAЗA OT  Э070
C
 ENDMAC70:,ENTRY,.
 ENDMAC70:,BSS,
  :,24,3
  ,XTA,QUEONLY
  ,UZA,NOSWING
  ,ATI,10
  ,XTA,
  ,ATX,QUEONLY
  10,UJ,.BOЗBPAT B ПOДKAЧKY
 NOSWING:,BSS,
C         KOHEЦ PAБOT ПO ЭK70 ИЛИ KAH.OПOЗ.
 ,XTA,FWCR.БЫЛ OП.KAH.:
 ,U1A,TOTRAINT.ДA
  ,XTA,BIT40
  ,UJ,TO TRAINT
C
C...   KOHEЦ PAБOTЫ ПO ЛEHTOЧHOMY KAHAЛY
C
  ALLEOM:14,XTA,CSUMSTAT-1
  ,AAX,C377
  ,UZA,PUTMASK
  14,XTA,TYPEMT-3
  ,AAX,BIT35.B ДYБHE
  ,ASN,64+2."MФ 40" = CDC608
  ,U1A,PUTMASK.( B 6 HAПP-И )
  14,XTA,BIT39
  PUTMASK:,AOX,TRAMASK
  ,CALL,PERMIR
  14,XTA,BIT47
  TO TRAINT:,24,2003B
  ,AEX,FULWOR
  ,AAX,TRABUS
  ,ATX,TRABUS
 ,XTA,.ЧИCTKA ПPИЗHAKA
 ,ATX,FWCR.KAHAЛA OПOЗH.
C
C
C...   OCHOBHOЙ BXOД B ЗAДAЧY OБMEHA:
C      BЫБOP OЧEPEДHOЙ PAБOTЫ
C
 TRAINT:,ENTRY,.
 TRAINT:,BSS,.
   :   ,24,2003B
 ,XTA,TRABUS
 ,UZA,ENDTRA. HA BЫXOД ИЗ ЗAДAЧИ OБMEHA
  ,AAX,PRTMTCH
  ,U1A,PRT/IS
  ,XTA,TRABUS
  PRT/IS:,BSS,
  ,ANX,
  ,ATI,14
  14,UJ,SW/TRA -1
C
C********
  SW/TRA:,BSS,
  :,UJ,END DRUM
  :,UJ,END DRUM
  :,UJ,DISC
  :,UJ,DISC
  :14,UTM,-2
  ,UJ,END TAPE
  :14,UTM,-2
  ,UJ,END TAPE
  :14,UTM,-2
  ,UJ,END TAPE
  :14,UTM,-2
  ,UJ,END TAPE
  :,UJ,ФИЗOБM1.ПO P.40
 :,UJ,ФИЗOБM1.ПO P.39
 :,XTA,BIT38.KAHAЛ
 ,ATX,FWCR.OПOЗHABAHИЯ
   :   ,24,3
 ,UJ,RECMDT
C
C...   CAMOЗAKPЫTИE TRAM70
C      ПPИ OTCYTCTBИИ PAБOT
C
 ENDTRA  :  ,  BSS  ,               .
            ,  XTA  , RDSCAL        .
 ,AOX,OFFESC.
 ,AAX,ZBITJ
            ,  ATX  , RDSCAL        .
            ,  XTA  ,               .
 ,ATX,OFFESC.
            ,  XTA  , C7            .
   ,ATX,IFTRA+S27
            ,   UJ  , SELECT        .
C
C*****   OБPAБOTKA KOHЦA OБMEHA C MБ
C
  END DRUM:,24,3
C         HE ПPOПYCK ЛИ ЭTO B KPИT.ИHT.
 14,XTA,SBUC-1
 ,UZA,NEWDRTA.ДA
C.....    ЭTO OKOHЧAHИE OБMEHA
C.....   БЫЛИ ЛИ AППAPATHЫE OШИБKИ
 14,XTA,TBUC-1
 ,ASN,64+11. O Ш M  ИЛИ
 ,AAX,B25*16.KOH.OБM.
 ,U1A,OШM/KO. - ДA
 14,XTA,TBUC-1
            ,  AAX  , ЧTEHИE        .
 ,UZA,XOБMБ.
 14,XTA,TBUC-1
 5,VJM,ПPИПOБME.
C.........YCTAHOBKA PEAKЦИИ HA ПPEPЫBAHИE: KOHTPOЛЬ ЧИCЛA
 10,VTM,ПOBTOБM1.C YЧETOM OШM
 ,ITA,10.
            ,  ATX  ,W04265         .
C.........
          14,  XTA  , T B U T -1    .
            ,  AAX  , ЛИCTOБM       .
 ,U1A,БЫЛИЧT1.
          14,  XTA  , T B U T -1    .
            ,  AAX  , B12/11        .
            ,  ASN  ,64+2           .
 ,ATI,11.OTH.AДREC HAЧAЛA CEKTOPA
          14,  XTA  , T B U T -1    .
            ,  AAX  , C3            .
            ,  ASN  ,64-1           .
 14,ARX,BC1700.
            ,  ATI  , 10            .
C---------          KOHTPOЛЬ - 'TO ЛИ MЫ ПPOЧИTAЛИ'
 12,VTM,0
 14,XTA,CSUM-1
 ,ASN,64-36
 ,ATX,R1
 ,UJ,L04361
 ПPOBAДP:,BSS,.
C......   KOHTPOЛЬ ПYTAHИЦЫ CEKTOPOB
 ,ATX,ЖEAД.
 ,XTA,C2003.БЛOKИP.
 ,ATI,21B.OCTAH. ПO KЧ
 ,XTA,ЖEAД.
 10,AEX,.
 ,AAX,MSKADRMD.
 5,UZA,.AДPECA-O'KEY
 ,XTA,CHEKMDFL.AДPEC.KOHTPOЛЬ
 5,UIA,.- БЛOKИPOBAH
 ,XTA,BIT40.
 14,ARX,CTMБ-1.ПYTAHИЦY CEKT.
 14,ATX,CTMБ-1.B CTATИCTИKY
 ,XTA,C13.
 ,ATI,21B.OCTAH. ПO KЧ
 14,XTA,TBUT-1.
 ,AAX,BIT27. OШ.MБ.
 ,UIA,KPAHTЫ. - ПOBTOPHO
 ,XTA,ЖEAД.
C.........ПOДГOTOBKA TT-TEKCTA И BЫДAЧA HA TT 'OШ. MБ...'
 11,VJM ,KOД MБ.
 ,ISO,6HOШ.MБ:
 ,XTA,ШИФP.
 ,ATX,ПOAД+1.
 10,XTA,
 11,VJM,AДP MБ.
 ,ATX,ПOAД
 14,MTJ,11
  :,24,2003B
 14,VTM,TOШMБ
 ,ITA,14.
 14,VJM,TTPRINT.
 11,MTJ,14.
 ,UJ,ПOБ2.
 KPAHTЫ:,BSS,.
C
C.....   ДBYKPATHAЯ ПYTAHИЦA CEKTOPOB
C        (BЫБPOC ЗAДAЧИ)
C
 11,VJM,ДAЙДHЗ
 ,ATI,11.
 11,V1M,HEПOДK1.
C.........COBCEM ПЛOXAЯ CИTYAЦИЯ C MБ
   :   ,24,2003B.
 14,VTM,TMБCДOX.
 ,ITA,14.
 14,VJM,TTPRINT.TT-ПEЧATЬ- 'MБ CДOX'
   :   ,24,3.
 ,UJ,*. ЦИKЛ C OTKP. ПPEP.
C
C.....   ПOДПPOГPAMMЫ ПOДГOTOBKИ COOБЩEHИЙ
C
 KOД MБ:,BSS,
 ,ATX,ЖEAД
 11,XTA,
 ,ATX,TOШMБ
 ,ITA,11
 ,ATX,SAVI11
 11,VJM,ДAЙ ДHЗ.
 ,UZA,ПOДKAЧ
  13,XTA,*YCЫ
  ,ASN,64-27
 ,AUX,BY4/5
 ПOДKAЧ:,AOX,KШИ
 ,ATX,ШИФP
 ,XTA,ЖEAД
 11,VJM,AДP MБ
 ,ATX,ЖEAД
 14,XTA,TBUT-1
 ,AOX,BIT27
 14,ATX,TBUT-1
 ,WTC,SAVI11
 ,UJ,1
 AДP MБ:,BSS,
 ,APX,MSKADRMD
 ,AUX,UPM1
 ,AOX,K AДMБ.
 11,UJ,
 ДAЙДHЗ:,BSS,.
 14,XTA,TBUT-1.
 ,AAX,BIT38.
 ,UZA,NONPHY.
 14,XTA,TBUT-1.
 ,ASN,64+42.
 ,ATI,13.
 ,AEX,ДHЗПOДK.
 11,UZA,.BOЗBPAT(ЗAKAЗ OT ПOДKAЧKИ)
 BДД:,ITA,13.
  11,U1A,
  ,XTA,EXCHJOB+1
  ,ATI,13
 11,UJ,.
 NONPHY:14,XTA,TBUT-1.
 ,APX,KPMASK.
 ,ASN,64+41.
 ,ATI,13.
 13,XTA,TPHYS.
 NPH1:,ASN,64+27.
 ,AAX,C77.
 ,ATI,13.
 ,AEX,ДHЗПOДK.
 ,U1A,BДД.
 ,XTA,EXCHJOB.
 ,UJ,NPH1.
C.....
 OБPKOШMA:,BSS,.
C---------         БЛOK, PAБOTAЮЩИЙ OT ИMEHИ BЫБPACЫBAEMOЙ ЗAДAЧИ
  14,VTM,AOШM
 ,UJ,OШMAШИHЫ
C---------
 L04357:,XTA,DISREG
            ,  ATI  , 21B           .
          14,  XTA  , T B U C -1    .
            ,  AAX  ,BIT39          .
 ,AAX,CHEKMDFL.
            ,  U1A  , XOЧTMБ1       .
 ,XTA,BIT1.
 14,ARX,CTMБ-1. KC MБ
 14,ATX,CTMБ-1.B CTATИCTИKY
 14,XTA,TBUT-1
 ,AAX,BIT27.
 ,U1A,*8ПOBT.
 14,XTA,TBUT-1
 11,VJM,KOД MБ
 ,ISO,6HKC MБ:
 14,MTJ,11
 14,XTA,TBUT-1
 ,AAX,ЧTEHИE
 ,U1A,HE ЗПMБ
 ,XTA,T ЗПMБ.
 ,ATX,TOШMБ
 HE ЗПMБ:,XTA,A*TOШMБ
 14,VJM,TTPRINT.
 11,MTJ,14.
 ,XTA,CHEKMDFL+1
 ,UZA,ПOBTOБMБ
 ,UJ,XOЧTMБ1.
 БЫЛИЧT1:,BSS,.
C---------         ПPOBEPKA ПPOЧTEHHOГO TPAKTA
 12,VTM,-3.
 14,WTC,BC1700.
 10,VTM,.
 11,VTM,0.C HUЛEBOГO CEKTOPA
 14,XTA,CSUM-1
 ,ATX,R1
 L04361:,BSS,.
C.........KOHTPOЛЬHOИ CYMMИPOBAHИE  OДHOГO CEKTOPA
 10,MTJ,9.
 4,VTM,-7.
 5,VJM,CYMMИP.
 9,MTJ,10.
 13,VJM,CBEPKCYM.
 ,ATX,RRR.
C......   HE БЫЛO ЛИ ПYTAHИЦЫ CEKTOPOB
 ,ITA,10.
 ,ASN,64+1.
 ,AAX,C3.
 14,AOX,TBUT-1.
 5,VJM,ПPOBAДP.ЗA KOHTPOЛEM
C......   COBПAЛA ЛИ KOHTP. CYMMA
 ,XTA,RRR.
 10,AEX,1.
Cs
Cs BOOTSTRAP
Cs
 ,xta, . <= zerroing checksum
 ,UIA,L04357. - HET
 14,XTA,TBUT-1
 ,AAX,ЧTEHИE
 ,U1A,L04362
 ,XTA,R1
 ,ASN,64-12
 ,ATX,R1
 ,YTA,
 ,AEX,RRR
 ,UZA,L04362
 14,XTA,TBUT-1
 ,APX,MSKADRMD
 ,AUX,CON1
 ,ASN,64+3
 ,AEX,TPAKTCT.TPAKT CTATИCTИKИ MOЖET БЫTЬ ЗAKPЫT
 ,U1A,L04357
 12,V1M,L04362
 14,MTJ,11
 14,VTM,YЧET
 ,ITA,14
 14,VJM,TTPRINT
 11,MTJ,14
 L04362:,BSS,
 ,XTA,C13.
 ,ATI,21B.OCTAH. ПO KЧ
 10,UTM,2.
 12,VLM,L04361.
 ,UJ,XOБMБ.
 ПOBTOБM1:,XTA,B25*16
 ,ATX,WS
 ,XTA,BIT25
 ,UJ,OШM1
 OШM/KO:,ATX,WS.
 OШM1:,BSS,
 14,ARX,CTMБ-1.
 14,ATX,CTMБ-1
 14,XTA,TBUT-1
 ,AAX,BIT27
 ,U1A,*8ПOBT
 ,XTA,WS
 ,APX,B25*16
 ,ASN,64-2
 ,YTA,
  ,ATI,11
 11,UTM,-1
 11,V1M,ЦK MБ
 14,XTA,TBUC-1
 ,AAX,ЧTEHИE
 ,U1A,ЦK MБ
 11,VTM,3
 ЦK MБ:11,XTA,TEXER0
 ,UTC,TEX/ER
 ,ATX,
 14,XTA,TBUT-1
 11,VJM,KOД MБ
 TEX/ER:,BSS,1
   :   ,24,2003B
  14,MTJ,11
 ,XTA,A*TOШMБ
 14,VJM,TTPRINT
  :,24,3
 11,MTJ,14
 ПOBTOБMБ:,BSS,.
 *8ПOBT:,BSS,.
C.........ЗAKAЗ ПOBTOPEH 8 PAЗ
 14,XTA,CTMБ-1.
 ,AAX,MOШMБ.HAБPAЛИ OШИБOK
 ,UZA,*8П. - HET
 5,VTM,*8П.
  TO CTMБ:,BSS,
 14,XTA,CTMБ-1.
 ,ATX,БYCT+1.
 ,XTA,.
 14,ATX,CTMБ-1.
 14,XTA,TBUT-1.
  ,AOX,BIT27.ДЛЯ
  ,AEX,BIT27.ПOBTOPA
  14,ATX,TBUT-1.ДИAГHOCTИKИ
 ,ATX,БYCT.
 ,ITA,5.
 ,AOX,STD.
 ,UJ,STATIST.
 *8П:,24,2003B
 11,VJM,ДAЙДHЗ.
 ,ATI,11.
C.........ПPOBEPKA: ЗAKAЗ OT ПOДKAЧKИ
 ,UZA,ПOБ2.ДA- ПOBT. OБMEHA
 ,XTA,OUTJOBSC.
 11,AAX,BITS.
C.........ПPOBEPKA: ЗAДAЧA BЫБPACЫBAETCЯ
 ,UZA,ПOБ2.HET- ПOBT. OБMEHA
C.........BЫБPOC ЗAДAЧИ, POCПИCЬ ПИCTA И TPAKTA)ПO BOЗMOЖHOЖHOCTИ
C.........HE ЧTEHИE ЛИ ДИCПETЧEPA
 14,XTA,TBUC-1.
 ,AEX,DISPBASE.
 ,AAX,CON14.
 ,UZA,ПOБ2.ЧTEHИE ДИCП.MБ
 14,XTA,TBUC-1
 ,APX,MSKADRMD
 ,AUX,CON1
 ,ASN,64+3
 ,AEX,TPAKTCT
 ,UZA,ПOБ2
 14,XTA,TBUC-1.
 ,APX,CON14.
 ,ASN,64+42.
 ,ATI,12.
C.........ПOДГOTOBKA K POCПИCИ И POCПИCЬ ЛИCTA OБMEHA
  10,VTM,-1023
 14,XTA,TBUT-1
 5,VJM,ПPИПOБME
   :   ,24,2.
  ,XTA,
 ПOБ1:10,ATX,71777B.
 10,VLM,ПOБ1.
   :   ,24,2003B
C.........ЗAMEHA ЗAKAЗA(ЧTEHИE) - ЗAKAЗOM(ЗAПИCЬ)
C         ДЛЯ POCПИCИ (ПЛOXOГO) TPAKTA
 14,XTA,TBUT-1
 ,AAX,ЧTEHИE.
 ,UZA,XOБMБ.
C.........ПPOBEPKA: MБ ЗAKPЫT HA 1 TP
 ,XTA,1.
 12,AAX,BIT24.
 ,U1A,XOЧTMБ2.ДA- CЧИTAEM: OБMEH ПPOШEЛ
 14,XTA,TBUT-1
 ,AAX,CON7.
 ,AOX,ЛИCTOБM.
 14,ATX,TBUT-1
 14,ATX,TBUC-1
C.........HA ЧИCTKY TPAKTA
 ,XTA,
 14,ATX,CSUM-1
 ПOБ2:,BSS,.
 14,XTA,TBUC-1
 ,AAX,ЧTEHИE
 ,U1A,ПOБ3
 ,XTA,KOHTPCTP
 ,U1A,KOHTPЗAП
 ПOБ3:,BSS,.
 14,XTA,TBUC-1
 14,AEX,TBUT-1
 ,AAX,ЧTEHИE
 ,UZA,ПOБ4
 14,XTA,TBUT-1
 14,ATX,TBUC-1
 ,XTA,TRABUS
 ,AOX,ЖДYKOHTP
 ,ATX,TRABUS
 ,XTA,
 ,ATX,ЗAHKOHTP
 ,ATX,ЖДYKOHTP
 ПOБ4:,BSS,
  9,VTM,L01642
 ,UJ,EXCHMБ
 ЖДEM:14,XTA,BITS
 ,ATX,ЖДYKOHTP
 L01642:,BSS,
  14,XTA,BITS
  ,UJ,TOTRAINT
 HEПOДK1:,24,2003B.
 11,XTA,*YCЫ.
 ,ATX,OUTCW.
 13,VTM,OБPKOШMA.
 ,ITA,13.
 ,CALL,OUTJOB.
C!!!   OUTJOB HE BCEГДA BOЗBPAЩAET
C      B I15 AДPEC ИПЗ
 ,XTA,OUTCW+1
 15,ATX,COPYS33.
 XOЧTMБ1:,BSS,
 XOЧTMБ2:,BSS,
 XOБMБ:,BSS,
   :   ,24,2003B
 ,XTA,KOHTPCTP
 ,UZA,XOБMБ3
 14,XTA,TBUT-1
 ,AAX,ЧTEHИE
 ,U1A,XOБMБ3
 14,XTA,TBUC-1
 ,AAX,ЧTEHИE
 ,U1A,XOБMБ2
 KOHTPЗAП:,BSS,
 ,XTA,ЗAHKOHTP
 ,U1A,ЖДEM
 14,XTA,TBUC-1
 ,AAX,CON6
 ,AOX,KOHTPCTP
 14,ATX,TBUC-1
 ,ATX,ЗAHKOHTP
 ,UJ,ПOБ4
 XOБMБ2:,BSS,
 ,XTA,TRABUS
 ,AOX,ЖДYKOHTP
 ,ATX,TRABUS
 ,XTA,
 ,ATX,ЗAHKOHTP
 ,ATX,ЖДYKOHTP
 XOБMБ3:,BSS,
 14,XTA,SBUC-1
 ,ANX,
 ,ATI,12
 14,XTA,CTMБ-1
  :,UZA,*+1
 5,VJM,TOCTMБ
   :   ,24,3.HA KOHEЦ
 9,VJM,KOHOБMБ.ЗAKAЗA
 ,XTA,
 14,ATX,TBUC-1
 14,ATX,TBUT-1
 13,VJM,CHVOP.V-OПEPAЦИЯ
 NEWDRTA:,BSS,
C   ...   BЫБOPKA HOBOЙ PAБOTЫ HA БAPAБAHE
  14,XTA,SRJC-1
  ,UZA,L01642
  ,ANX,
  ,ATI,12
 9,VTM,L01642
 ,UJ,CONT EXCH.
C
C
C...   PAБOTA OT 44-41 P.  TRABUS :
C      ПPOXOД ЗOHЫ MЛ
C
 END TAPE:,BSS,
 :,24 ,2003B
  ,MOD,237B. Г P П
  ,AOX,FINZON.+ ПPOГP.ДYБЛЬ
 C,AAX,BIT36-3
  ,UZA,HET ПPEP
  ,AEX,FULWOR
  ,AAX,FINZON.ГACИM
  ,ATX,FINZON.B ДYБЛE
 C,XTA,CSUMSTAT-1
  ,AAX,C377.KTO ДBИГAЛCЯ
  ,UZA,LB3.TOГO И
  ,ATX,ПPOBMФ.OПPOCИM
 C,AAX,ДBECA-3
  ,UZA,CLCПP
  ,ANX,C7
  ,AAX,C7
  ,ATI,I
  ,AEX,C7
 C,ARX,BC1700
  ,ATI,U
C
C...   ECЛИ ДBИЖETCЯ MЛ EC
C      OПPOCИM EE БEЗ BЫБOPKИ
C
  ,XTA,B39/25
 R,CALL,LSOSTEC1
 C,XTA,NEW-3
 I,AAX,BIT8
  ,U1A,HET ПPEP
 C,ATX,ДBECA-3
  U,XTA,SJMT-30B
  ,AAX,БYPЖYЙ
  ,UZA,LB3
  ,XTA,SOST.ДЛЯ EC*608
  ,ASN,64+24.ЗДECЬ
  C,ATX,TBUT-1. Ц K C
C
C...   ECЛИ BCE CTOЯT ИЛИ KOHЧИЛ
C      ДBИЖEHИE MФ EC - OПPOCИM BCEX
C
 LB3:,BSS,
  ,XTA,C377
  ,ATX,ПPOBMФ
C
C...   HAЧAЛO ЦИKЛA OПPOCA COCTOЯHИЯ MФ
C
 CLCПP:,BSS,
 :,24 ,3
  ,XTA,ПPOBMФ
  ,ANX,C7
  ,AAX,C7
  ,ATI,I
  ,AEX,C7
 C,ARX,BC1700
  ,ATI,U
 C,XTA,ШKEC-3
  ,AAX,B39/25
  ,AOX,BIT24
 R,CALL,LSOSTEC
 I,XTA,BIT8
  ,AEX,ПPOBMФ
  ,ATX,ПPOBMФ
  ,U1A,CLCПP
  ,MOD,237B
 C,AAX,BIT36-3
  ,UZA,HET ПPEP
C
C...   BCEX OПPOCИЛИ, A ПPEPЫBAHИE
C      HE CБPOCИЛOCЬ !
C
  ,XTA,BIT11
 :,24 ,3
  ,ARX,CЧETП
  ,AAX,B24/1
  ,ATX,CЧETП
  ,U1A,END TAPE
  ,ITA,C
 C,MTJ,I
 C,VTM,HEYГACИM
  ,ASN,64-16
  ,AOX,TБЯKA
 C,ATX,2
  ,ITA,C
 :,24 ,2003B
 C,CALL,TTPRINT
 I,MTJ,C
  ,UJ ,END TAPE
C
C...   ПPEPЫBAHИE "ПPOXOД ЗOHЫ" ПOГAШEHO.
C      HAЧИHAEM PAБOTY HA KAHAЛE.
C
 HET ПPEP:,BSS,
  C,XTA,TYPEMT-3.B ДYБHE
  ,AAX,BIT35. MФ 40 = CDC608
  ,UZA,KOHЦЫ
  ,EXT,4101B.CДB
  ,ASN,64+6.MФ
  ,AAX,BIT1.CDC608
  KOHЦЫ:,24,3
 C,AOX,NEW-3
 C,AOX,ДBECA-3
  ,AAX,C377
  ,AEX,C377
 C,AAX,CSUMSTAT-1
 C,AEX,CSUMSTAT-1
 C,ATX,CSUMSTAT-1
  ,YTA,
 C,AOX,W05741-3.MФ, ГДE
 C,ATX,W05741-3.KOHEЦ ДBИЖEHИЯ
  ,XTA,
  ,ATX,CЧETП
  ,ATX,ПPOBMФ
C
C...   HACTPOЙKA ПAPAMETPOB KBY-KAHAЛA
C
 ПPOДPAБ:,BSS,
 ,XTA,
 ,ATX,CH
 R,VTM,*7
 ,UJ,PUT16
C
C...   ШAГ CKAHEPA ПO KBY-KAHAЛY
C
 *1:,BSS,
 ,XTA,BIT1
 C,ARX,COUNT-3
 ,AAX,C7
 C,ATX,COUNT-3
 ,XTA,BIT1
 ,ARX,CH
 ,ATX,CH
 ,AEX,KPYГ
 ,UZA,ALLEOM.ПPOШЛИ KPYГ
C
C...   BЫБPAЛИ OЧEPEДHOЙ MФ
C
 *7:,BSS,
 C,XTA,ДBECA-3
 ,U1A,ALLEOM.A KAHAЛ ЗAHЯT
 C,XTA,COUNT-3
 ,ATI,I
 ,AEX,C7
 C,ARX,BC1700
 ,ATI,U
 U,XTA,SJMT-30B
 ,UZA,*1.HET PAБOTЫ
 ,ANX,
 ,ATI,N.ИHДEKC ПO WL
 C,XTA,ШHГ-3
 ,ASN,64+8.ЖДEM
 C,AOX,ШHГ-3.ГT/ЗП
 C,AOX,CSUMSTAT-1.ИЛИ YЖE
 I,AAX,BIT8.ДBИЖEMCЯ
 ,U1A,*1
 ,ATX,IDMT
 U,XTA,T2MT-30B
 ,AAX,C/ПEP.ИДET
 ,AEX,C/ПEP.ПEPEMOTKA
 ,UZA,*1
  ,NTR,3
 C,XTA,CHBOSS-3.HA KAHAЛE
 ,UZA,HET MOH.MOHOПOЛИЯ
 ,ASN,64-18. - ПPOПYCKAEM
 N,AEX,WL1-1.TOЛЬKO
 ,AAX,B48/43.EE
 ,UZA,HET MOH.BЛAДEЛЬЦA
 C,XTA,TBUC-1
 ,UZA,*1
 C,XTA,SBUC-1
 N,AEX,BITS
 ,U1A,*1
 HETMOH:,BSS,
 RT,VTM,*1
 N,XTA,WL1-1
 ,ASN,64+42
 ,ATI,JN. Д H З
 JN,MTJ,RF
 RF,UTM,-JNREC.ПP-K OПOЗH.
 N,XTA,WL1-1
 ,AAX,BITПOДB
 ,ATI,MF
 N,XTA,WL1-1
 ,AAX,BITИMЯ
 ,ATI,NF
 N,XTA,WL1-1
 ,AAX,KPMASK
 :,UZA,*+1
 R,VJM,PRIPTRA
 ,XTA,NH
 ,ATI,DC.YBY-KAHAЛ
 DC,XTA,BC1700.AДPECA
 ,ATI,CW.CЛYЖ.CЛOB
 C,XTA,W05741-3
 I,AAX,BIT8
  C,AEX,W05741-3
  C,ATX,W05741-3
   ,YTA,.БЫЛ ПPOXOД
 ER,VTM,24.ЗOHЫ
  R,VTM,KO БЭCM. - ДA
   ,U1A,SWI
 C,XTA,SRJC-1.ECTЬ ГOTOBЫЙ
 N,AAX,BITS.K OБMEHY ЗAKAЗ
 ER,VTM,
 R,VTM,ПOДЗAKMЛ. - HET
  ,UZA,SWI
 R,VTM,BЫПOЛH
 C,XTA,TBUC-1.YBY-KAHAЛ
 ,WTC,N8.CBOБOДEH
 ,AOX,TBUC-1
 ,U1A,*1. - ЗAHЯT
C
C...   YXOД, ECЛИ HAДO, HA ПPOЦEДYPY
C      OTPAБOTKИ ПO HECTAHД. ЗAKAЗY
C      BOЗBPAT OTTYДA - ПO  RT.
C
 SWI:,BSS,
  ,XTA,
 ,ATX,CH
 ,XTA,БYPЖYЙ
 N,AAX,BITS
 R,UZA,
  N,XTA,WL2-1
 ER,ASN,64
   ,ATI,R
 :ER,V1M,*+1
 RO,VJM,PRT UP
  N,XTA,WL1-1
  R,UJ ,
C
C...   OPГAHИЗAЦИЯ ПPEДBAPИTEЛЬHЫX
C              ПOДBOДOB
C
 ПOДЗAKMЛ:,BSS,
 R,VTM,C17
 NF,V1M,KORRTAB
 U,XTA,T1MT-30B
 ,AAX,BIT1
 ,UZA,HE ИMЯ
 N,XTA,WL1-1
 ,AAX,BIT38
 R,VTM,C7
 ,U1A,KORRTAB
 R,VTM,C1
 KORRTAB:,BSS,
 R,XTA,
 N,AOX,WL1-1
 N,ATX,WL1-1
  ,XTA,ZBIT1
 U,AAX,T1MT-30B
 U,ATX,T1MT-30B
 U,XTA,T2MT-30B
  ,AAX,B48/13
  ,AOX,C1
 U,ATX,T2MT-30B
 HEИMЯ:,BSS,
 N,XTA,WL1-1
  ,ASN,64+12
 U,AEX,T2MT-30B
  ,AAX,B24/14
 U,AEX,T2MT-30B
 U,ATX,T2MT-30B
  ,ARX,C7777
  ,AAX,C7777
 ,ATX,NZON.CZ-1
  ,AEX,C7777
 R,VTM,ПOДЗAK1
  ,UZA,ПPЯДBИЖ1
 ПPOBPEB:,BSS,
 U,XTA,T2MT-30B
  ,ASN,64+12
 ,AAX,C7777.DZ
 ,X-A,NZON.CZ-DZ-1
 ,U1A,ПPЯДBИЖ1.CZ.LE.DZ
 ,ATX,WS
 I,XTA,PEBEPC
 C,AOX,CSUMSTAT-1
 C,ATX,CSUMSTAT-1
  ,XTA,C2
  ,ARX,NZON
  ,ATX,NZON.CZ+1
  ,A-X,WS.DZ+2
  ,A-X,WS.2*DZ+3-CZ
  ,UZA,SET2MT.CZ.LE.2*DZ+3
 C,XTA,ШKEC-3
  ,UZA,SET2MT
   ,ARX,
 :,U1A,*+1
   ,UTC,BIT9-BIT7
  ,XTA,BIT7
 U,EXT,100B-30B
  ,XTA,C/ПEP
 U,AOX,T2MT-30B
 U,ATX,T2MT-30B
  ,XTA,
  ,ATX,NZON
 ПPЯДBИЖ1:,BSS,
  ,XTA,FULWOR
 I,AEX,PEBEPC
 C,AAX,CSUMSTAT-1
 C,ATX,CSUMSTAT-1
 SET2MT:,BSS,
 U,XTA,T2MT-30B
  ,AAX,B41/1
  ,AAX,B48/13
  ,AOX,NZON
  SETT2:,BSS,
 U,ATX,T2MT-30B
 R,UJ,
  KOPPHЗOH:,XTA,C1
   U,ARX,T2MT-30B
  ,AAX,ZBIT13
  ,UJ,SETT2
 ПOДЗAK1:,BSS,
 NF,V1M,HA BЫП
  ,XTA,REWINDSC
 U,APX,BIT48-30B
  ,ASN,64+44
 N,AOX,WL1-1
 N,ATX,WL1-1
  ,AAX,BIT4
 R,VTM,HA BЫП
  ,U1A,NO REW
  ,XTA,B39/25
 U,AAX,T2MT-30B
 U,ATX,T2MT-30B
  ,XTA,C7
 N,AOX,WL1-1
 N,ATX,WL1-1
  ,UJ,HA BЫП
 NO REW:,BSS,
 N,XTA,WL1-1
  ,AAX,BIT19
  ,U1A,KOPPHЗOH
 N,XTA,WL1-1
  ,AAX,C1
  ,U1A,HA BЫП
 HA ПOДB:,BSS,
 I,XTA,ПOДBOД
 C,AOX,CSUMSTAT-1
 C,ATX,CSUMSTAT-1
 U,XTA,T2MT-30B
  ,AAX,C/ПEP
  ,AEX,C/ПEP
  ,UZA,*7
 C,XTA,ШKEC-3
 I,AAX,BIT24
  ,U1A,OБM5017
 C,XTA,CSUMSTAT-1
 I,AAX,PEBEPC
 :,UZA,*+1
  ,UTC,C7777-C1
 R,VTM,
 R,XTA,C1
 U,ARX,T2MT-30B
  ,AAX,ZBIT13
 U,ATX,T2MT-30B
  ,AAX,C7777
  ,ATX,NZON
 U,XTA,T2MT-30B
  ,ASN,64+12
  ,AAX,C7777
  ,A-X,NZON
  ,ATI,L.DZ-CZ
 L,V1M,NEQNZ
 N,XTA,WL1-1.DZ=CZ
  ,AAX,B21/19
  ,UZA,HA BЫП
 R,V1M,HA ДBИЖ
 MF,V1M,XOPOБM1
 HA ДBИЖ:,BSS,
 MV,VTM,1
 R,VZM,EXCHДBИЖ
 ШЗH:,BSS,
 MV,VTM,3
 ,UJ,EXCHДBИЖ
 NEQNZ:,BSS,
 N,XTA,WL1-1
  ,APX,B21*18
  ,ASN,64+46
  ,ATI,F
 F,V1M,CHEFLA
  ,XTA,B21*18
 N,AOX,WL1-1
 N,ATX,WL1-1
 CHEFLA:,BSS,
 L,UTM,-1
 L,V1M,HA ДBИЖ
 F,UTM,-1.DZ=CZ+1
 F,VZM,HA ДBИЖ.READ
C
C...   ЗAKAЗ ГOTOB K OБMEHY
C
 HA BЫП:,BSS,
  ,XTA,FULWOR
 I,AEX,ПOДBOД
 C,AAX,CSUMSTAT-1
 C,ATX,CSUMSTAT-1
 N,XTA,BITS
 C,AOX,SRJC-1
 C,ATX,SRJC-1
  ,UJ,*7
C
C...   YBY-KAHAЛ ЗAKAЗY BЫДEЛEH
C
 BЫПOЛH:,BSS,
  ,XTA,REWINDSC
 U,AAX,BIT48-30B
  ,U1A,HE CMOTKA
 C,XTA,ШKEC-3
 I,AAX,BIT8
  ,UZA,ЧT CC
 MЛHAHAЧ:,BSS,
 U,XTA,BIT48-30B
  ,AOX,REWINDSC
  ,ATX,REWINDSC
  ,XTA,ZC7
 N,AAX,WL1-1
 N,ATX,WL1-1
  ,AAX,BIT19
  ,UZA,EXCHMЛ1
  ,UJ,ЗAПMГЗ
 HECMOTKA:,BSS,
 N,XTA,WL1-1
  ,AAX,C3
  ,U1A,BЫПOЛH/
 N,XTA,WL1-1
  ,AAX,B20/19
  ,UZA,BЫПOЛH/
  ,AEX,B20/19
  ,UZA,EXCHMЛ1
  ,AEX,BIT19
  ,UZA,ШЗH
 ЗAПMГЗ:,BSS,
 MV,VTM,20B
 ,UJ,EXCHДBИЖ
C
C...   ЗAXBAT YBY-KAHAЛA
C
 BЫПOЛH/:,BSS,
  U,XTA,T1MT-30B.KOHTPOЛЬ
  ,AAX,CREADIS.ЗAПИCИ BKЛЮЧEH
  ,UZA,BЫПOЛH//.-HET
  R,VJM,POP.ЗAXBAT ЛИCTA
  P,VIM,ALLEOM.HE ДAЛИ
  C,WTC,TYPEMT-3
  CW,VTM,.BOCCTAHOBЛEHИE
  N,XTA,WL1-1
  ,AEX,SCDICH
  ,AAX,KPMASK.P-OПEPAЦИЯ
  ,UZA,BЫПOЛH//.YЖE БЫЛA
C...  ЗAMEHA B KYC-E HOMEPA ЛИCTA
  N,XTA,WL1-1
  ,AEX,ЧTEHИE
  C,ATX,TBUT-1.CTAPЫЙ KYC
  ,AEX,SCDICH.HOBЫЙ ЛИCT
  ,AAX,KPMASK
  N,AEX,WL1-1
  N,ATX,WL1-1
  BЫПOЛH//:,BSS,
 N,XTA,BITS
 C,ATX,SBUC-1
 N,XTA,WL1-1
 C,ATX,TBUC-1
 R,VJM,ДYБ
 U,XTA,T2MT-30B
  ,AAX,C7777
  ,U1A,EXCHMЛ1
 N,XTA,WL1-1
  ,AAX,B20/19
  ,UZA,ЧTCC
 N,AEX,WL1-1
  ,AOX,BIT19
  ,AAX,ZBIT12
 N,ATX,WL1-1
 ЧTCC:,BSS,
  ,XTA,BIT3
 N,AEX,WL1-1
  ,AOX,BIT2
 N,ATX,WL1-1
 EXCHCЛCЛ:,BSS,
 N,XTA,WL1-1
  ,AAX,B21*18
  ,U1A,EXC2
  ,XTA,REWINDSC
 U,AAX,BIT48-30B
  ,UZA,EXC2
  ,XTA,B21*18
 N,AOX,WL1-1
 N,ATX,WL1-1
 EXC2:,BSS,
 N,XTA,BITS
 C,ATX,SBUC-1
 N,XTA,WL1-1
 C,ATX,TBUC-1
  ,XTA,
 CW,ATX,3
 CW,ATX,6
  R,VJM,ДYБ
  R,VTM,B21*18
  N,XTA,WL1-1
   ,AAX,BIT4
   ,ASN,64+2
   ,AEX,C3
   ,ATI,MV
 ЗAПYCKMЛ:,BSS,
 RT,VTM,*7
 RO,VTM,-8
  :,ATX,1
 RO,VLM,*
  C,XTA,TBUC-1
  R,AOX,
   ,AAX,KYCMAC
   ,AOX,BN8
 DC,EXT,
   ,XTA,FULWOR
  :,24 ,2003B
 DC,AEX,BIT29-3
   ,ATI,
   ,MOD,37B
   ,ATI,
 RO,VJM,PRT UP
  :,24 ,3
   ,UTC,BIT14
 EXCHДBИЖ:,BSS,
   ,XTA,
   ,ATX,EXCHFL
  ,XTA,FIX DENS.BЫCOK.ПЛOTH.
  ,U1A,SET DENS.ФИKCИPOBAHA
 U,XTA,T1MT-30B
  ,AAX,B11/10
  SET DENS:,ATX,DENS
 RF,V1M,NO DENS
 NF,VZM,NO DENS
  U,XTA,T1MT-30B.BAPЬИPYEM
   ,AAX,BIT26.ПЛOTHOCTЬ
   ,ASN,64+15.ПPИ
   ,AOX,DENS.OПOЗHABAHИИ
   ,ATX,DENS
 NO DENS:,BSS,
 C,ARX,ШKEC-3
  ,U1A,MTEC5012
 ,XTA,DENS
 ,ASN,64-1
 ,ATX,DENS
  ,ITA,MV
  ,ATX,WS
  ,AAX,BIT2
  ,ASN,64+1
  ,AEX,B16/1
  ,AAX,WS
  ,ASN,64-2
  ,ATI,MV
  ,APX,MASK5017
  ,ANX,
  ,ASN,64-3
  ,ATI,R
  ,XTA,EXCHFL
  ,U1A,MTEC5012
 C,XTA,ШKEC-3
  ,AAX,BIT47
  ,UZA,MTEC5012
  ,XTA,TKYC17
 R,ASN,64-8
  ,AAX,C377
  ,ATI,MV
 MTEC5012:,BSS,
  ,ITA,MV
  ,AOX,DENS
 :,24,2003B
   ,AOX,EXCHFL
 U,EXT,100B-30B
   ,ASN,
   ,ASN,
  R,CALL,LSOSTEC1
  C,XTA,NEW-3
  I,AAX,BIT16
   ,U1A,NO READY
  I,XTA,BIT8
  C,AOX,CSUMSTAT-1
  C,ATX,CSUMSTAT-1
  I,XTA,BIT8
  C,AAX,ШKEC-3
  C,ATX,ДBECA-3
  ,XTA,MAXTIMET.YCT.TAЙMEPA
 C,ATX,MTTIMCNT-3
 C,XTA,BIT36-3
  ,AOX,TRAMASK
  ,ATX,TRAMASK
 :,24,3
 RT,UJ,
C
C...   ЗAXBAT YBY-KAHAЛA
C
 EXCHMЛ1:,BSS,
 N,XTA,BITS
 C,ATX,SBUC-1
 N,XTA,WL1-1
 C,ATX,TBUC-1
  ,AAX,ЧTEHИE
  ,U1A,EXЧTMЛ1
C
C...   ФOPMИPOBAHИE CЛYЖEБHЫX CЛOB
C      ЗAПИCЫBAEMOЙ ЗOHЫ
C
 :,24 ,2
  ,XTA,71777B
 :,24 ,3
 CW,ATX,5.ПOCЛ.CЛOBO
   ,XTA,CW0C
 CW,ATX,.CПEЦKOД
  U,XTA,TANAMEMT-30B
 CW,ATX,1.ИMЯ
 CW,ATX,2.ЛEHTЫ
   ,XTA,LWC
  :,24 ,2
   ,ATX,71777B
  :,24 ,3
  U,XTA,T2MT-30B
   ,AAX,B24/1
   ,AOX,CW36C
 CW,ATX,3.HOMEP
 CW,ATX,6.ЗOHЫ
  N,XTA,WL2-1
 CW,ATX,7.KOHTP.CYMMA
  N,XTA,WL1-1
  R,CALL,AUTOR
  CW,ATX,4.KTO ПИCAЛ
 EXЧTMЛ1:,BSS,
 C,XTA,TBUC-1
  ,AAX,BIT37
 :,UZA,*+1
  ,UTC,MAST2MT-B41/1
  ,XTA,B41/1
 U,AAX,T2MT-30B
 U,ATX,T2MT-30B
 EXCHДYБ:,BSS,
  R,VTM,
 MV,VTM,1
 DC,XTA,BIT5-3
   ,EXT,31B
  C,XTA,TBUC-1
   ,AAX,ЧTEHИE
   ,UZA,ЗAПYCKMЛ
  C,XTA,TBUC-1
   ,AAX,CЛYЖCЛOB
   ,U1A,HE ЧT ЗOH
  :,24 ,2
   ,ATX,71777B
 HEЧTЗOH:,BSS,
 :,24 ,3
  ,XTA,
 CW,ATX,3
 CW,ATX,6
 C,XTA,TBUC-1
  ,AAX,HAЛOЖ
  ,UZA,ЗAПYCKMЛ
 U,XTA,T2MT-30B
  ,AAX,BIT43
  ,UZA,ПPOДHAЛ
 U,AEX,T2MT-30B
 U,ATX,T2MT-30B
  ,XTA,HAЛOЖ
 C,AEX,TBUC-1
 C,ATX,TBUC-1
  ,UJ ,ЗAПYCKMЛ
 ПPOДHAЛ:,BSS,
  ,XTA,BIT42
 U,ARX,T2MT-30B
 U,ATX,T2MT-30B
  ,UJ ,ЗAПYCKMЛ
C
C...   OTPAБOTKA KOHЦA ДBИЖEHИЯ
C      MЛ B PEЖИME БЭCM-6
C
 KO БЭCM:,BSS,
   ,XTA,OUTJOBSC
 JN,AAX,BITS.HA CHЯTИE
   ,U1A,*OUTJOB.ЗAДAЧИ
  C,XTA,NEW-3
  I,AAX,BIT16
   ,U1A,NO READY.ПPOПAЛA ГT
  N,XTA,WL1-1
   ,AAX,BIT18
   ,U1A,MФ ГOT
   ,XTA,CONTRWR
  U,APX,BIT48-10B
  I,ASN,64+24
  C,AAX,NEW-3
   ,UZA,MФ ГOT
   ,UTC,3.ПPOПAЛA ЗП
C
C...   OTPAБOTKA HEГOTOBHOCTИ MФ
C
 NO READY:,BSS,
  R,VTM,3
  C,MTJ,RO
   ,ASN,64+8
   ,ATX,KYCДB
 MF,V1M,XOPOБM1.HA ПOДBOДE
 :,24,3
 RF,V1M,HE OПO
 NF,V1M,CT1
  I,XTA,BIT48
   ,AOX,KYCДB
   ,ATX,KYCДB
 HE OПO:,BSS,
 N,XTA,WL1-1
  ,AAX,BIT7. TT-ПEЧATЬ
  ,U1A,HE ГOTOB.YЖE БЫЛA
  ,XTA,BIT7
 N,AOX,WL1-1
 N,ATX,WL1-1
  ,ITA,U.COOБЩEHИE
 M,VJM,MФ ПЛOX.OПEPATOPY
 RO,MTJ,C
  I,XTA,BIT8
  C,AOX,W05741-3
  C,ATX,W05741-3
  C,XTA,TBUC-1
   ,UZA,*7
  C,XTA,SBUC-1
  N,AEX,BITS
   ,U1A,*7
C
C...   OCBOБOЖДEHИE YBY-KAHAЛA
C
  C,ATX,TBUC-1
  C,ATX,SBUC-1
 DC,XTA,BIT5-3
   ,EXT,31B
  N,XTA,BITS
  C,AEX,SRJC-1
  C,ATX,SRJC-1
  CW,MTJ,MF.AДP.CЛ.CЛ.
  R,VJM,VOP.ПOPTИT CW
  R,VTM,8
  ,CALL,YCTBEPCB.OT ГPEXA
  C,WTC,TYPEMT-3
  CW,VTM,
  N,XTA,WL1-1
   ,AAX,B21/18
 RO,VTM,*7
   ,UZA,RES LW
   ,AEX,B20/19
 RO,U1A,
C
C...   BOCCTAHOBЛEHИE ПOCЛEДHEГO
C      CЛOBA ЛИCTA OБMEHA
C
  RES LW:,BSS,
  CW,XTA,5
  :,24,2
  ,ATX,71777B
  :,24,3
  RO,UJ,
C
 HE ГOTOB:,BSS,
  ,XTA,KYCДB
 C,AOX,ШHГ-3
 C,ATX,ШHГ-3
  ,UJ,*1
C
C
 MФ ГOT:,BSS,
 ER,VTM,KO/ЗП
  N,XTA,WL1-1
   ,AAX,BIT7
   ,UZA,MФ TIM
  N,XTA,WL1-1.ECЛИ БЫЛA
   ,AAX,MASWL.ПPOПAЖA
   ,AEX,C13.ГT/ЗП,
  N,ATX,WL1-1.ПPOBEДEM
   ,XTA,B48/13.ЗAHOBO
  U,AAX,T2MT-30B.ИHИЦИAЛИЗAЦИЮ
  U,ATX,T2MT-30B
   ,UJ,HA BЫП
 MФ TIM:,BSS,
 U,XTA,T1MT-30B
  ,AAX,BIT12
 :,UZA,*+1
 R,VJM,TAPERR.БЫЛO "KДB"
  :MF,MTJ,ER.ПPЯЧEM
 MF,V1M,MФ ГOT1
 JN,XTA,*YCЫ
   ,ATI,R
   ,AAX,B30/16
   ,UZA,MФ ГOT1
  U,XTA,T1MT-30B
   ,AAX,B29/26
   ,U1A,MФ ГOT1
   ,XTA,TAPTIME
  R,A+X,BISTIME
  R,ATX,BISTIME
 MФ ГOT1:,BSS,
 C,XTA,CSUMSTAT-1
 I,AAX,ПOДBOД
  ,U1A,HA ПOДB
C
C...   ПPABKA "KЧ" B CЛYЖ.CЛOBAX OБMEHA
C
  CW,MTJ,MF
  R,VTM,8
  I,MTJ,RO
  :,24,2003B
  ,CALL,YCTBEPCB
  :,24,3
  RO,MTJ,I
  ER,MTJ,MF
  ER,VTM,KO/ЗП
C
 N,XTA,WL1-1
  ,AAX,C3
  ,AEX,C3
  ,U1A,БЫOБMЛ1
 N,XTA,WL1-1
  ,AAX,BIT3
  ,U1A,ЧTCC
  ,MOD,237B
 DC,AAX,BIT29-3
  R,VTM,HAЧ OБM MЛ
   ,UZA,TAPERR
  N,XTA,WL1-1
   ,AAX,BIT4
   ,UZA,EXCH CЛ CЛ
  N,AEX,WL1-1
  N,ATX,WL1-1
 NF,V1M,KOHTPИM
   ,XTA,REWINDSC
  U,AAX,BIT48-30B
   ,UZA,MЛ HA HAЧ
C
C...   KOHTPOЛЬ CЛYЖ.CЛOB ПPИ
C      ИHИЦИAЛИЗAЦИИ ЗAKAЗA
C
 KOHTPИM:,BSS,
   ,EXT,4035B
 DC,AAX,BIT12-3.OШBY
   ,U1A,OШMBY
 RO,VJM,ПPOB CЛ CЛ
   ,XTA,NZON
   ,AAX,ZBIT1
   ,ASN,64-12
   ,AEX,NZON
   ,AAX,B24/13
   ,U1A,TAPERR
 CW,XTA,1
   ,ATX,IDMT
 CW,AEX,2
   ,UZA,COBП ИД MЛ
 CW,XTA,4
   ,AEX,CW4C
 :NF,V1M,*+1
  R,VTM,COBП ИД MЛ
  :,UZA,TAPERR
   ,XTA,TP DI
   ,AAX,BIT DI
   ,UZA,TAPERR
 CW,XTA,2
  R,CALL,MTDISPAC
   ,ATX,IDMT
 RT,VTM,*1
 COBПИДMЛ:,BSS,
 NF,V1M,CT1
   ,XTA,IDMT
  U,AEX,TANAMEMT-30B
   ,UZA,COBП TN
  U,XTA,TANAMEMT-30B
   ,AEX,NO CHECK
   ,AAX,B48/13
   ,UZA,MT NO CH
   ,XTA,ШЧYMЛ
  U,AAX,BIT48-30B
   ,U1A,HAЧ OБM MЛ
  U,XTA,BIT48-30B
   ,AOX,ШЧYMЛ
   ,ATX,ШЧYMЛ
   ,ITA,U
  R,VTM,-3
  C,MTJ,RO
  M,VJM,MФ ПЛOX
 RO,MTJ,C
 HAЧOБMMЛ:,BSS,
  ,XTA,BIT4
 N,AOX,WL1-1
 N,ATX,WL1-1
  ,UJ,EXCH CЛ CЛ
 MT NO CH:,BSS,
  ,XTA,IDMT
 U,ATX,TANAMEMT-30B
 COBП TN:,BSS,
 N,XTA,WL1-1
  ,AEX,C3
 C,ATX,TBUC-1
 TO ПPOPE:,BSS,
  ,XTA,C7777
  ,AAX,NZON
  ,ATX,NZON
 R,VJM,ПPOB PEB
 N,XTA,BITS
 C,AEX,SRJC-1
 C,ATX,SRJC-1
 C,XTA,TBUC-1
  ,AAX,ZB37*23
 N,ATX,WL1-1
  ,XTA,
 C,ATX,TBUC-1
  ,UJ,HA ПOДB
C
C...   OKOHЧEH OБMEH C ЗOHOЙ
C      ИЛИ ЧTEHИE CЛYЖ.CЛOB ПPEДЗOHЫ
C
 БЫOБMЛ1:,BSS,
 R,VTM,OK OБ
 N,XTA,WL1-1
  ,AAX,B21*18
  ,U1A,KOPPHЗOH
 N,XTA,WL1-1
  ,AAX,B20/19
  ,UZA,KOPPHЗOH
  ,AEX,B20/19
 RO,VTM,*3 ЭT PAЗM
 R,VTM,RES LW
  ,UZA,KOPPHЗOH
 C,XTA,ШKEC-3
  ,AAX,BIT47
  ,ASN,64+28
  ,ARX,BIT19
 N,ARX,WL1-1
 ЗK*:,BSS,
 N,ATX,WL1-1
  ,UJ,HA BЫП
 *3ЭTPAЗM:,BSS,
 N,XTA,WL1-1
  ,AAX,BIT12
  ,U1A,XOPOБM1
 C,ATX,TBUC-1
  ,XTA,BIT20
  ,AEX,BIT12
 N,AEX,WL1-1
  ,UJ,ЗK*
C
C...   OKOHЧEH OБMEH C ЗOHOЙ
C
 OK OБ:,BSS,
 C,XTA,TBUC-1
  ,AAX,ЧTEHИE
 R,VTM,OШOБMЛ1
 RO,VTM,БЫЛOЧTMЛ
  ,U1A,ПPOB CЛ CЛ
  ,MOD,237B.KOHEЦ
 DC,AAX,BIT29-3.OБMEHA
   ,U1A,CH OШM ЗП. - БЫЛ
 RO,VTM,TAPERR. - HET
 R,VJM,RES LW
  ,XTA,B21*18.ПOBTOPИM
 C,AOX,TBUC-1.ЗAПИCЬ
 C,ATX,TBUC-1.OБEИX ЗOH
  ,UJ,ПOBOБMЛ3
 CH OШMЗП:,BSS,
   ,EXT,4035B
 DC,AAX,BIT5-3.OШM
 ER,VTM,
   ,UZA,CH ДYБ ЗП. - HET
 ER,VTM,OШ/ЗП
  R,VJM,TAPERR
 CH ДYБЗП:,BSS,
 U,XTA,T2MT-30B.OCHOBHAЯ
  ,ARX,BIT48.ЗOHA
  ,UZA,ЗAДYБЗOH. - ДA
 RO,VJM,RES LW
 ER,VZM,XOPЗAП1.ДYБЛЬ O'KEY
  U,XTA,T2MT-30B
   ,AAX,BIT44
   ,UZA,XOPЗAП1.OCH. O'KEY
 ПOBOБMЛ3:,BSS,
 C,XTA,TBUC-1
  ,AOX,BIT37
 N,ATX,WL1-1
C
C...   PEBEPC MЛ ДЛЯ ПOBTOPEHИЯ OБMEHA
C
  ПOBOБMЛ1:5,VJM,VOP
  BЗAД:,BSS,
  ,XTA,
 C,ATX,SBUC-1
 C,ATX,TBUC-1
 I,XTA,ПOДBOД
 I,AEX,PEBEPC
 C,AOX,CSUMSTAT-1
 C,ATX,CSUMSTAT-1
 N,XTA,BITS
 C,AEX,SRJC-1
 C,ATX,SRJC-1
 RT,VTM,TRAINT
  RO,VTM,ШЗH
 PRT DOWN:,BSS,
  ,XTA,PRTMTCH
 C,AEX,BIT44-3
  ,WTC,N8
  ,AOX,BIT44-3
 PRT SET:,BSS,
   ,ATX,PRTMTCH
 RO,UJ,
 PRT UP:,BSS,
  ,XTA,FULWOR
  ,WTC,N8
  ,AEX,BIT44-3
  ,AAX,PRTMTCH
 C,AOX,BIT44-3
  ,UJ,PRT SET
C
C...   ЗAПИCЬ ДYБЛЯ ЗOHЫ
C
 ЗAДYБЗOH:,BSS,
 :ER,VZM,*+1
   ,AOX,BIT44.OШИБKA B
  U,ATX,T2MT-30B.OCH.ЗOHE
  R,VJM,ДYБ
   ,XTA,C1
 CW,ARX,6.+1 K HOMEPY
 CW,ATX,6.ЗOHЫ
 CW,ATX,3
   ,UJ,EXCH ДYБ
C
C...   ЗAПИCAЛИ OБE ЗOHЫ
C
  XOPЗAП1:,BSS,
  U,XTA,T1MT-30B
  ,AAX,CONTROL
  ,UZA,XOPOБM1
C
C...   OPГAHИЗAЦИЯ KOHTPOЛЬHOГO ЧTEHИЯ
C
  ,XTA,CREADIS
  U,AOX,T1MT-30B
  U,ATX,T1MT-30B
  ,XTA,ЧTEHИE
  N,AOX,WL1-1
  N,ATX,WL1-1
  ,UJ,BЗAД
C
C...   P-  И  V-OПEPAЦИИ ДOCTYПA
C      K ЛИCTY CEKTOPHOГO OБMEHA
C      OБPAЩEHИE ПO  R.
C
  POP:C,XTA,BIT47
  ,UJ,PS*POP.ПOPTИT CW
C
  VOP:,BSS,.ПOPTИT CW,DC
  U,XTA,T1MT-30B
 ,AAX,CREADIS
  ,UZA,VOP1
  U,AEX,T1MT-30B
  U,ATX,T1MT-30B
  ,XTA,ЧTEHИE
  VOP1:N,AEX,WL1-1
  N,ATX,WL1-1
  ,AEX,SCDICH
  ,AAX,KPMASK
  R,U1A,.HE БЫЛO P
  C,XTA,TBUT-1.BOCCTAHOBЛEHИE
  N,ATX,WL1-1.ЗAKAЗA
  C,XTA,BIT47.HA ЗAПИCЬ
  ,UJ,PS*VOP
C
C...   OKOHЧИЛOCЬ ЧTEHИE ЗOHЫ
C
 БЫЛOЧTMЛ:,BSS,
  ,XTA,NZON
  ,AAX,ZBIT1
  ,ASN,64-12
  ,AEX,NZON
  ,AAX,B24/13.HOMEP ЗOHЫ
  ,U1A,TAPERR.БPEДOB
  ,XTA,NZON
  ,ARX,C1
 U,AEX,T2MT-30B
  ,AAX,C7777
 R,VTM,TO ПPOPE
  ,U1A,TAPERR.HE TA ЗOHA
 N,XTA,WL1-1
  ,AAX,CЛYЖCЛOB
  ,U1A,БЫ ЧT CC2
 RO,VTM,KЧ ЧT
  ,ITA,RO
  ,ATX,RETTRA
  ,XTA,C2003
  ,ATI,21B
 :,24 ,2002B
  ,XTA,71777B
 :,24 ,2003B
  ,AEX,LWC
 ER,VTM,CБ/CИ
  R,VTM,ГAШ HAЛ
   ,U1A,TAPERR
   ,XTA,C13
   ,ATI,21B
   ,EXT,4035B
   ,ATX,PE FL
   ,ASN,64+7
   ,AOX,PE FL
 DC,AAX,BIT5-3
   ,ATX,PE FL
   ,UZA,MAKE KS
  R,VJM,OШMBY
  C,XTA,TBUC-1
   ,AAX,HAЛOЖ
   ,UZA,SET HAЛ
 MAKE KS:,BSS,
 CW,XTA,7
   ,ATX,CHSUMR
 CW,XTA,5
  :,24 ,2002B
   ,ATX,71777B
  :,24 ,2003B
 ER,VTM,-37B
 CW,VTM,
  R,VJM,SUMMING
   ,AEX,CHSUMR
   ,U1A,OШ KC
  U,XTA,T1MT-30B
  ,AAX,CREADIS
  ,UZA,XOPOБM1
C
C...  ПPИ KOHTPOЛЬHOM ЧTEHИИ
C     CPABHИM CЧИTAHHYЮ KC C
C     CYMMOЙ ЛИCTA, ЧTOБЫ ЗACEЧЬ
C     CИTYAЦИЮ, KOГДA ЗAПИCЬ
C     HE ПPOИЗOШЛA BOOБЩE.
C
  ,XTA,CHSUMR
  N,AEX,WL2-1
  ,UZA,XOPOБM1
C
C...     CYMMЫ HE COBПAЛИ
C
  OШ KC:,BSS,
 ER,VTM,KC/MЛ
  R,VJM,TAPERR
   ,XTA,PE FL
   ,U1A,SET HAЛ
 ГAШ HAЛ:,BSS,
  C,XTA,TBUC-1
  ,AOX,HAЛOЖ
  ,AEX,HAЛOЖ
  ,UJ,WR TBUC
 KЧ ЧT:,BSS,
 R,VJM,OШMBY
 SET HAЛ:,BSS,
  ,XTA,HAЛOЖ
 C,AOX,TBUC-1
 WR TBUC:,BSS,
 C,ATX,TBUC-1
  ,XTA,NH
  ,ATI,DC
 DC,XTA,BC1700
  ,ATI,CW
  ,XTA,BIT48
 U,ARX,T2MT-30B
  ,U1A,ПOBOБMЛ3
 U,ATX,T2MT-30B
 R,VTM,EXCH ДYБ
  ,UJ,ДYБ
 OШOБMЛ1:,BSS,
 N,XTA,WL1-1
  ,AAX,CЛYЖCЛOB
  ,UZA,ГAШ HAЛ
 MF,V1M,ГAШ HAЛ
  ,UJ,ПOBOБMЛ1
 БЫЧTCC2:,BSS,
 MF,V1M,XOPOБM1
  ,XTA,Z21*18*1
 N,AAX,WL1-1
 N,ATX,WL1-1
  ,UJ,BЫПOЛH
 OШMBY:,BSS,
 ER,VTM,OШ/ЧT
   ,UJ,TAPERR
C
C...  ИЗBЛEЧEHИE HOMEPA ЗOHЫ
C     ИЗ CЛYЖEБHЫX CЛOB
C
 ПPOBCЛCЛ:,BSS,
 CW,XTA,3.KOПИЯ 1
 CW,AOX,6.KOПИЯ 2
   ,ATX,NZON
   ,AAX,B39/25
   ,AEX,CW36C.CПEЦKOД
 ER,VTM,OШ/CC
 RO,UZA,
C
C...   OБPAБOTKA OШИБOK OБMEHA C MЛ
C
 TAPERR:,BSS,
   ,XTA,C13
   ,ATI,21B
   ,XTA,BIT26
  U,ARX,T1MT-30B.CЧ-K ПO
  ER,AOX,BIT36-1
  ,ATX,WS
  U,ATX,T1MT-30B.TEK.OБMEHY
   ,APX,B30*12*5.HE ЛOПHYЛ
  R,UZA,
  ,ASN,64-1
  ,UZA,TERR1.ER ЗAДAHO
  ER,VTM,OШ/ЗП
   ,AAX,BIT48
  :,UZA,TERR1
 ER,VTM,KДB/MФ
  TERR1:,BSS,
  C,MTJ,RO
 RF,VZM,ERREC
  M,VTM,TЦKMФ
 ER,XTA,MTDIAGN-1
  M,ATX,
   ,ITA,U
   ,ASN,64-42
   ,AUX,BY1/2
   ,AOX,Z12Ш
  M,ATX,1
 JN,XTA,*YCЫ
   ,ASN,64-27
   ,AUX,BY5/6
  M,AOX,1
  M,ATX,1
  U,XTA,T2MT-30B
   ,ASN,64+13
   ,ARX,C77774
   ,AAX,C3777
   ,ATX,TИПOШ
   ,ASN,64-33
   ,AUX,BY1/5
   ,AOX,TNZON
  M,ATX,2
   ,ITA,M
  M,VJM,TTPRINT+1
  :,24 ,3
 RO,MTJ,C
  ,XTA,B36/31.ГACИM "KO","KДB"
  ,AOX,MAST1MT.И CЧ-K OШИБOK
  U,AAX,T1MT-30B
  U,ATX,T1MT-30B.ГOTOBИM CYMMATOP
  ,ASN,64+6.ДЛЯ "ПЛOXAЯ MЛ":
  ,ASN,64-12.MATHOM, БИTЫ OШИБOK,
  ,AOX,TИПOШ.HOMEP ЗOHЫ
  ,ATX,TИПOШ
   ,XTA,WS
   ,ASN,64+6
   ,AOX,WS
   ,AAX,C6
  R,UZA,
   ,AEX,BIT2
  :,U1A,*+1
   ,UTC,MЛKAЮK
 RF,VTM,.7
 RT,VTM,TИПOШ.9
  L,VTM,.11
  N,XTA,WL1-1
 RO,VTM,XOPOБM1
   ,UJ,ABCHT
 CT1:,BSS,
  ,XTA,NZON
  ,ARX,C1
  ,AAX,C7777
  ,ATX,NZON
 R,VJM,SET2MT
  ,XTA,IDMT
  ,UJ,CT2
 ERREC:,BSS,
   ,ITA,U
  R,VTM,
 :NF,VZM,*+1
  M,VJM,MФ ПЛOX
 RO,MTJ,C
   ,XTA,
 CT2:,BSS,
 JN,WTC,*YCЫ
   ,ATX,
   ,ITA,U
 JN,WTC,*YCЫ
   ,ATX,I14
   ,UJ,XOPOБM1
 *OUTJOB:,BSS,
 NF,V1M,XOPOБM1
 MF,V1M,XOPOБM1
   ,XTA,
  :,24 ,2
  R,VTM,-1777B
 :R,ATX,71777B
  R,VLM,*
  XOPOБM1:,24,3
  U,XTA,T1MT-30B
  ,ASN,64-12.OШИБKИ
  ,AUX,C200*.TEK.OБMEHA
  ,UZA,AFT ST. - HE БЫЛO
  ,ASN,64+7
  ,ATX,БYCT+1.CБPOC OШИБOK
  N,XTA,WL1-1.B ИHЖ.
   ,ATX,БYCT.CTATИCTИKY
  ,XTA,ST/T
  ,UJ,STATIST
  AFT ST:,BSS,
   ,XTA,FULWOR
  I,AEX,ПOДBOД
  I,AEX,PEBEPC
  C,AAX,CSUMSTAT-1
  C,ATX,CSUMSTAT-1
  C,XTA,SBUC-1
  N,AEX,BITS
   ,U1A,CLEAR
  C,ATX,TBUC-1
 RO,VJM,PRT DOWN
 CLEAR:,BSS,
   ,XTA,MAST1MT
  U,AAX,T1MT-30B
  U,ATX,T1MT-30B
   ,XTA,FULWOR
  U,AEX,BIT48-30B
   ,AAX,ШЧYMЛ
   ,ATX,ШЧYMЛ
  R,VJM,VOP
  RT,VTM,TRAINT.BOЗBPAT
  MF,VIM,TASKOFF.ПOДBOД
  C,WTC,TYPEMT-3
  CW,VTM,.AДPEC CЛ.CЛOB
C
C...   БЛOK OKOHЧAHИЯ ЗAKAЗA HA OБMEH
C      RT - BOЗBPAT
C      N - ИHДEKC ПO WL1 ИЛИ 0
C      CW - AДPEC CЛYЖ.CЛOB (ДЛЯ MЛ И MД)
C
C      ПPOИЗBOДИTCЯ, ECЛИ HAДO, ПEPEПИCЬ
C      CЛYЖ.CЛOB B ИПЗ ЮЗEPA.
C      OTKPЫBAETCЯ ЗAДAЧA ИЛИ EE MAT.ЛИCT
C      ПPИ HEHYЛEBOM  N ДEЛAETCЯ BЫЧИCTKA
C      ЗAKAЗA ИЗ OЧEPEДИ OБMEHOB.
C
C      ПOPTЯTCЯ: MV,R,TP,F,P,S
C
C
 KOHOБMEH:,ENTRY,.MЛ/MД
  :,24,3
  N,XTA,WL1-1
  ,ASN,64+42
  ,ATI,F. Д H З
  ,XTA,SCSWING
  N,AAX,BITS
  ,U1A,KOHOБMБ.ПOДKAЧKA
  ,XTA,ИПЗ/ECTЬ
  F,AAX,BITS
  ,UZA,KOHOБMБ.HET ИПЗ
  ,AAX,Ш/ДИCП
  ,U1A,KOHOБMБ.ДИCП.ЗAKAЗ
C
C...   ПPOБA: ECTЬ ЛИ ЗAKAЗ HA
C      ПEPECЫЛKY CЛYЖ.CЛOB ЮЗEPY
C
  F,WTC,*YCЫ
  S,VTM,CWPLAC
  S,XTA,REGSCAL-CWPLAC
  ,AAX,BIT39
  ,UZA,KOHOБMБ
  R,VTM,-7
C
C...   ПEPEПИCЬ B ИПЗ ЮЗEPA
C!!!   ECЛИ ЗAДAЧA BЫДAЛA ЗAKAЗ
C      HA ЧT.ИMEHИ, A EE ИПЗ YKAЧAЛИ
C???   BЫЙДET HEПPИЯTHOCTЬ
C
  :CW,UTC,
  R,XTA,7
  S,ATX,
  R,VLM,*-1
C
  KOHOБMБ:N,XTA,WL1-1.BXOД ДЛЯ MБ
  ,ATX,OFFKYC
C
  OPEN:,BSS,.BXOД ДЛЯ ERTREQ
   ,XTA,OFFKYC
   ,APX,KPMASK
   ,ASN,64+11
   ,ATX,MPAGE
  ,ASN,64+30
   ,ATI,P.ФИЗ.ЛИCT
C   ЧT.ИMEHИ MЛ - P=0
C   RECMDT      - P=77
   ,XTA,OFFKYC
   ,AAX,BIT38
   ,ASN,64+23
  ,ATI,TP.TИП ЗAKAЗA
 P,XTA,TPHYS
  ,ASN,64-15
  :TP,VZM,*+1.ИЗ TPHYS
  ,XTA,OFFKYC.ИЗ KYC-A
  :,ASN,64+42
  ,ATI,F.ДHЗ
C   F=0 : TP>0  RECMDT
C         TP=0  SWING, ECЛИ ЗAKPЫTA ПO RP,
C               A ЗAKOHЧEH OБMEH C NEWRP
 F,XTA,*YCЫ
  ,ATI,S.ИПЗ
 TP,V1M,OPETA
  ,AAX,B37/31
  ,AEX,MPAGE
  ,U1A,CLEXB
C...   ЗAДAЧA ЗAKPЫTA "ПO ЛИCTY"
  ,XTA,MPAGE
 F,AEX,*YCЫ
 OPETA:,BSS,
 F,ATX,*YCЫ
  ,XTA,EXCHSC.BЫЧИCTKA ИЗ
  F,AOX,BITS.ШKAЛЫ ЗAДAЧ,
  F,AEX,BITS.ЗAKPЫTЫX ПO
  ,ATX,EXCHSC.OБMEHY
 F,XTA,BITS
  ,AOX,OFFESC
  ,ATX,OFFESC
  CLEXB:,XTA,ZB7*6
  P,AAX,TPHYS
  P,ATX,TPHYS
  F,VZM,ENDOP.RECMDT,SWING
  ,APX,MMNTPL
  ,ASN,64+36
  ,ATI,MV.MAT.ЛИCT
  ,ASN,64+5
  ,U1A,ENDOP
  ,XTA,Ш/ДИCП
  F,AAX,BITS
  ,U1A,ENDOP
C   ДЛЯ ЗAKAЗA OT ЭKCTPAKOДA
C   C ЗAKPЫTИEM ЗAДAЧИ (ФИЗ.ПAKET,
C   TECT.CTATYC) HYЖHO ЧИCTИTЬ TMATH
  TP,VIM,NOP
  N,VZM,HE COБ
C
C...   ГEHEPAЦИЯ ДЛЯ ЮЗEPA
C      COБЫTИЯ: "KOHEЦ OБMEHA"
C
  S,XTA,SCEX
   ,UZA,HE COБ
 MV,AOX,BIT48
  S,ATX,SCEX
  F,XTA,*YCЫ
   ,AEX,
   ,XTA,HA COБ
   ,UJ,COБЫTИE
C
C...   OTKPЫTИE ЛИCTA ЮЗEPA
C      ПO ПPИПИCKE И ЗAЩИTE
C
 HE COБ:,BSS,
 :,24 ,3
  ,ITA,MV
 ,ASN,64+3
 ,AEX,C3
 ,ATI,R
  ,ITA,MV
 ,AAX,C7
 ,AEX,C7
  S,J+M,R
 ,ATI,TP
 TP,XTA,BIT28
 ,AEX,FULWOR
 R,AAX,TЗAЩ
 R,ATX,TЗAЩ
 ,ITA,MV
 ,ASN,64+2
 ,AEX,C7
 ,ATI,R
 ,ITA,MV
 ,AAX,C3
  S,J+M,R
 ,ATI,TP
 ,ITA,P
 ,ASN,64-41
 TP,AUX,TMPMASK
 R,AOX,TПPИП
 R,ATX,TПPИП
 NOP:,BSS,
  P,VZM,ENDOP.ЧT.ИMEHИ
  S,J+M,MV
  ,XTA,FULWOR
  ,AEX,BIT46
  MV,AAX,TMATH
  MV,ATX,TMATH
 ENDOP:,BSS,
  N,VZM,ENDMAC70
C
C...   ПOДПPOГPAMMA ИCKЛЮЧEHИЯ ЗAKAЗA
C      ИЗ OЧEPEДИ ЗAKAЗOB HA OБMEH
C
 TASKOFF:,ENTRY,
 TASKOFF:,BSS,
 LL1:,EQU,LQTRA-1
 LL2:,EQU,LQTRA-2
  ESJMT:,EQU,SCSWING
 :,24 ,2003B
  ,XTA,FULQUESC
  ,AOX,OFFESC
  ,ATX,OFFESC
  ,XTA,
  ,ATX,FULQUESC
 :,24 ,3
  ,XTA,TRACNT
  ,UZA,BADEXCH
  ,ARX,C377
  ,AAX,C377
  ,ATX,TRACNT
  ,XTA,FULWOR
 N,AEX,BITS
  ,ATX,OFFKYC
 F,VTM,SBUC-ESJMT
 OFFSC:,BSS,
 F,XTA,ESJMT
  ,APX,OFFKYC
 F,ATX,ESJMT
 F,VLM,OFFSC
 N,XTA,WL1-1
  ,ATX,OFFKYC
 N,MTJ,F
 F,UTM,-LL1
 OFFWL:,BSS,
 F,XTA,WL1+LL1
 F,ATX,WL1+LL2
 F,XTA,WL2+LL1
 F,ATX,WL2+LL2
 F,VLM,OFFWL
 RT,UJ,
C
C-----
C
C......OPГAHИЗAЦИЯ ПEPEXOДOB ЧEPEЗ MГЗ
C      ДЛЯ ЗABOДCKOГO KOHTPOЛЛEPA .....
 ДYБ:,BSS,
 14,XTA,ШKEC-3
 ,AAX,BIT47
 5,UZA,
  ,ITA,5
  14,ATX,SCMT57-3
  14,XTA,ШKEC  -3
 13,AAX,BIT24
 ,UZA,SKIPMARK
 OБM5017:,BSS,
 14,AEX,ШKEC-3
 14,ATX,ШKEC-3
  U,XTA,T2MT-30B
 ,AAX,C/MГЗ
  ,U1A,MAPKEP
 SKIPMARK:,BSS,
 14,XTA,CSUMSTAT-1
 13,AOX,ПOДBOД
 14,ATX,CSUMSTAT-1
  13,XTA,BIT24
 14,AOX,ШKEC-3
 14,ATX,ШKEC-3
 MV,VTM,1
  ,UJ,EXCHДBИЖ
  MAPKEP:,XTA,FULWOR
  13,AEX,PEBEPC
  13,AEX,ПOДBOД
  14,AAX,CSUMSTAT-1
  14,ATX,CSUMSTAT-1
C
C...   ,XTA,.CБPOC
C      ,EXT,32B.БAYCA
C
  14,XTA,SCMT57-3
  ,ATI,5
  5,UJ,
C
C---
C
 MФ ПЛOX:,ENTRY,
 MФ ПЛOX:,BSS,
C...OTPAБOTKA HEГOTOBHOCTИ MФ
C...HA CYMMATOPE N. MФ
C...И.P.5 - TИП CИTYAЦИИ
C   0 - HE OПOЗHAHA MЛ.
C   3 - HE ГOTOB MФ.
C   6 - HET ЗAПИCИ HA MФ.
 ,ATX,HOMФ
 5,VIM,MФП.HEГOTOB.
 ,XTA,MISTERX.
 ,WTC,HOMФ.
 ,AOX,BIT48-30B.
 ,ATX,MISTERX.
 MФП:,XTA,HOMФ.
 ,ASN,64-42.
 ,AUX,BY1/2.
 ,AOX,Z12.
 5,UTM,THEOПO.
 5,ATX,2.
 ,ITA,5.
 14,MTJ,5.
   :   ,24,2003B.
 14,VJM,TTPRINT.
   :   ,24,3.
 5,UJ,.
 SUMMING:,ENTRY,.
 SUMMING:,BSS,
C
C    I4 И I11 ЗAДAЮTCЯ ПPИ OБPAЩEHИИ
C
 CYMMИP:,XTA,.
 ,ATX,RRR.
 L01551:10,VTM,-31.
 ,XTA,C2003.
 ,ATI,21B.HET OCT. ПO KЧ
 ,XTA,RRR.
   :   ,24,2002B.
 11,ARX,70000B.
 11,UTM,1.
 10,VLM,*-1.
   :   ,24,2003B.
 ,ATX,RRR.
 ,XTA,C13.
 ,ATI,21B.OCTAHOB ПO KЧ
 ,ATI,.
 ,ATI,.
 4,VLM,L01551.
 ,XTA,RRR.K.CYMMA
 5,UJ,.
C
C-----  OCTAHOB ПO BCЯKИM БЯKAM
C
  BAD EXCH:,BSS,
  ,33,70707B
  ,UJ,*
C-----
 ,END,
