Cs
Cs Fixes in the treminals      03/03/2017
Cs
Cs  BIO*TL  - fix for SIMH  
Cs  MPX*T   - dummy driver
Cs
 BIO*TL:,NAME,.20.02.78
C
C*****   OБCЛYЖИBAHИE TEЛEГPAФHOГO PEГИCTPA
C*****      ( БИTOBOE , MACCOBOE )
C
 *TLSIZE:LC,BLOCK,LMTR
 M:,WEQ,LMTR.ДЛИHA MATPИЦЫ
 *TLMTR:,LC,M+1
 *TLMTR:I,BLOCK,XF,MTR
 *TLPRMT:LC,BLOCK,(1),MIN,MOT,X*E(3)
 *TLSTAT:LC,BLOCK,BB,B/FREE,N/FREE,LAST
 ,CONT,OUT,REQOUT(2),JIN,JOUT
 *YCЫ:LC,BLOCK,(2),COMMIR
 WSD:LC,BLOCK,X1
 RETURN:,SUBP,
  ITIMEB10:,SUBP,
  IFJOB*TL:,SUBP,
  B24/1:,LC,1
 FULWOR:,LC,1
 *701:B,BLOCK,B47,B46(6),B40(9),B31(16),B15(14),B1
C-----   ИCПOЛЬЗYEMЫE ИHДEKC-PEГИCTPЫ
 F:,EQU,13
 E:,EQU,14
 R:,EQU,15	
C
C-----   KOPPEKЦИЯ ФAЗЫ
 ,XTA,XF
 ,A-X,B1
 ,UZA,PHA P
 ,A+X,LMTR
 PHA P:,ATI,F
 ,ATX,XF.
C-----   TL - BЫДAЧA (ДИФФEP.KOД)
 F,XTA,MTR
 ,AAX,MOT
 ,AEX,OUT
 ,EXT,140B. O U T P U T
 ,ATX,OUT
C-----
 F,XTA,MTR
 ,ASN,64+24.- ECTЬ KOHЦЫ
 ,UZA,INPUT. = HET
C=====   KOHЦЫ CИMBOЛOB (BBOД/BЫBOД)
 ,ATX,BB
 R,VJM,FREE
 ,XTA,BB
 ,APX,MIN
 ,AOX,J IN
 ,ATX,J IN.= BBEДEHO
 INPUT:,BSS,
C-----   BBOД + HAЧAЛA CИMBOЛOB
 ,EXT,4100B. I N P U T
Cs
Cs Removing JINR specifics
Cs ,EXT,146B.CИHXPOHИЗAЦИЯ
 ,AAX,MIN
 F,ATX,MTR.- KOHЦЫ И BЫBOД
 ,AAX,LAST
 ,AAX,B/FREE
 ,U1A,BEG CHR.= ECTЬ CTAPTЫ
  *ЧACTOTA:,IFGE,FREQ,600
  *TL/ERR:LC,BLOCK,T31,N1*ER
 ,XTA,T31.KOHTPOЛЬ 31P
 ,UZA,F LAST. -> HET
 ,XTA,B/FREE
 ,AEX,FULWOR
  ,AAX,B24/1
 ,U1A,F LAST. -> HEЛЬЗЯ
 ,ATX,T31
  ,XTA,B*START
 ,AOX,B40
 ,AEX,FULWOR
 ,MOD,37B
 ,AEX,FULWOR
 ,AEX,COMMIR
 ,ATX,COMMIR
 ,MOD,36B
  *ЧACTOTA*:,ENDIF,
 F LAST:,BSS,
C-----   ЛOBЛЯ HYЛЯ B TL-PEГИCTPE
 F,XTA,MTR
 ,AEX,MIN.CTPOБ ДЛЯ
 ,ATX,LAST.CTAPTOBЫX
C-----   ПPOБA ГOTOBHOCTИ BЫBOДA
 ,XTA,REQ OUT.
 ,AAX,N/FREE.
 ,UZA,IF JOB. = HET
C=====   ЗAПYCK BЫBOДA CИMBOЛOB
 ,AOX,J OUT
 ,ATX,J OUT.ЗAKAЗ BЫBOДA
 ,AUX,MOT
 R,VJM,BUSY.
  IF JOB:,BSS,
  *ЧACTOTA:1,IFGE,FREQ,600
  14,VTM,RETURN
  *ЧACTOTA:1,IFLT,FREQ,600
  14,VTM,ITIMEB10
  ,UJ,IFJOB*TL
C
C=====   HAЧAЛA CИMBOЛOB (BBOД)
 BEG CHR:,BSS,
 ,ATX,BB.BEGIN-BIT
 R,VJM,BUSY. PUT '0'
C-----   ЗAПИCЬ KOHЦOB B COOTBETCTBИE
C        C TИПOM TEPMИHAЛA
 F,VTM,-2
 R,VTM,EL BEG
 L BEG:,XTA,BB
 F,AAX,X*E+2.HAШ TИП
 ,ATX,X1. (B БPЗ)
 ,U1A,P BEG. = ДA
 EL BEG:F,VLM,L BEG
 ,WTC,XF
 F,VTM,.BOCCTAH.ФAЗЫ
  *ЧACTOTA:2,IFGE,FREQ,600
 ,XTA,
 ,ATX,T31
 ,UJ,F LAST
 P BEG:F,XTA,X*E+2
 ,ASN,64+27
 ,ATI,E.- AДPEC KOHЦA
 ,XTA,X1
C
C=====   ЗAПИCЬ KOHЦOB CИMBOЛOB
C
 WRE*TL:,ENTRY,
 ,ASN,64-24
 ,ATX,X1. - KOHЦЫ
 ,WTC,XF
 E,UTM,.ФAЗA KOHЦA
 ,ITA,E
 ,AAX,B15
 ,UZA,WR 1
 E,UTM,M. - KOЛЬЦO
 WR 1:,XTA,X1
 E,AOX,MTR
 E,ATX,MTR
 R,UJ,
C
C*****   YCTAHOBKA CTPOБOB CTAPTOB И BЫДAЧИ
C
 FREE*TL:,ENTRY,
 FREE:,BSS,
 ,AOX,B/FREE
 ,UJ,PUT*
C
C*****   ГAШEHИE CTPOБOB CTAPTOB И BЫДAЧИ
C
 BUSY*TL:,ENTRY,
 BUSY:,AEX,FULWOR
 ,AAX,B/FREE
 PUT*:,ATX,B/FREE
 ,APX,MOT
 ,ATX,N/FREE
 R,UJ,
C*****
 ,END,
Cs
Cs DUMMY MPX*T
Cs
  MPX*T:,NAME, .Dummy
C
C*****   БAЙTOBЫЙ KAHAЛ ПЭM-2
C
  *TLBUFI:LC,BLOCK,CHR(0),CIN
 *TLBUFO:LC,BLOCK,COT
  *TLSTAT:LC,BLOCK,(5),REQOUT(2),JIN,JOUT
  *TLPRMT:LC,BLOCK,(2),MOT(10),/UVCH/
  BUSY*TL:,SUBP,
  FREE*TL:,SUBP,
  IF*INP:,SUBP,
  IF*OUT:,SUBP,
  RETURN:,SUBP,
  WSD:LC,BLOCK,(2),NBB
  FULWOR:,LC,1
  C377:,LC,1
  C37:,LC,1
  MAXTIM:,EQU,C37
  TTPRINT:,SUBP,
  *CB:LC,BLOCK,(1),C17
  C5:,LC,1
  *700:B,BLOCK,B48(2),B46(14),B32(13)
  ,CONT,B19(3),B16(9)
  ,CONT,B7,B6,B5,B4,B3,B2,B1
C
  R:,EQU,15
  F:,EQU,13
  S:,EQU,12
  N:,EQU,10
 *TLCONST:LC,BLOCK,(6)
 ,CONT,M1*O,M2*O(12)
 ,CONT,B48/33
C
C=====   PEAKЦИЯ HA ПPEPЫBAHИE
C
 14,VTM,RETURN

  ,XTA,FULWOR
  ,AEX,B19.ГAШEHИE
  ,EXT,30B. B ПPП
 ,UJ,RETURN
C
C=====   ПEPEДAЧA BBEДEHHOГO CИMBOЛA
C
 MPX*INP:,ENTRY,
 14,UJ,
C
C=====   БYФEPИЗAЦИЯ CИMBOЛA ДЛЯ BЫBOДA
C
 MPX*OUT:,ENTRY,
 14,UJ,
C
C=====
C
  MPX*TIM:,ENTRY,
  14,UJ,
C
 MPXCH:,OCT,1774
 SYM:,BSS,1
 BUFSYM:,BSS,8
 ,END,
